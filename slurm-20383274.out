...Tue Jun  8 19:20:54 CEST 2021: - begin running script
#!/bin/bash -l
#SBATCH --account=snic2021-5-248
#SBATCH --partition=core
#SBATCH --ntasks=10
#SBATCH --time=3-00:00:00
#SBATCH --job-name=test_with_quotes
#SBATCH --mail-user=zn.tportlock@gmail.com
#SBATCH --mail-type=ALL
##SBATCH --output=/proj/uppstore2019028/projects/metagenome/theo/newscripts/meteor/logs/%j 

set -a

function Run {
	echo "...$(date): $1 - begin"
	$@ \
	&& (echo "...$(date): $1 - done"; echo "") \
	|| (echo "...$(date): $1 - failed"; echo ""; exit 1)
}
function Parse_variables {
	v_project_dir=$TMPDIR/$sampleId
	v_workdir="${v_project_dir}/working/$sampleId"
	v_fastqgz1=$(readlink -f ${fastqgzs[0]})
	v_fastqgz2=$(readlink -f ${fastqgzs[1]})
	v_fastqgz1_unzip="${v_workdir}/$(basename $v_fastqgz1 .gz).unzipped"
	v_fastqgz2_unzip="${v_workdir}/$(basename $v_fastqgz2 .gz).unzipped"
	v_trimmedS="${v_workdir}/${sampleId}.trimmed.s.fastq"
	v_final1="${v_workdir}/${sampleId}_1.fastq"
	v_final2="${v_workdir}/${sampleId}_2.fastq"
	v_sampledir=${v_project_dir}/${catalog_type}/sample/${sampleId}
	v_downstream_dir="$v_project_dir/Downstream"
	vars=$(compgen -A variable | grep "^v_.*")
	for var in ${vars}; do echo "${var}=${!var}"; done
	for var in ${vars}; do if [[ -z "${!var}" ]]; then echo "missing argument ${var}" ; return 1 ; fi ; done
}
function Init {
	mkdir -p ${v_project_dir}/${catalog_type}/{sample,mapping,profiles}
	mkdir -p $TMPDIR/reference
	mkdir -p ${v_workdir}
}
function Send {
	cp $v_fastqgz1 ${v_workdir}
	cp $v_fastqgz2 ${v_workdir}
	cp -r ${reference_dir}/* $TMPDIR/reference
	cp -r ${trimFasta} $TMPDIR
}
function Decompress {
	zcat ${v_workdir}/$(basename $v_fastqgz1) > $v_fastqgz1_unzip & pid1=$!
	zcat ${v_workdir}/$(basename $v_fastqgz2) > $v_fastqgz2_unzip & pid2=$!
	trap "kill -2 $pid1 $pid2" SIGINT
	wait
}
function Trim {
	[[ -f $v_fastqgz1_unzip && -f $v_fastqgz2_unzip ]] \
	|| (echo "zip file not found" ; return 1 )
	java -jar ${ALIEN_TRIMMER}/AlienTrimmer.jar \
		-k 10 -l 45 -m 5 -p 40 -q 20 \
		-if ${v_fastqgz1_unzip} -ir ${v_fastqgz2_unzip} -c $TMPDIR/$(basename $trimFasta) \
		-of ${v_final1} -or ${v_final2} -os ${v_trimmedS} \
	|| return 1
}
function Import {
	[[ -f $v_final1 && -f $v_final2 ]] \
	|| (echo "trimmed files not found" ; return 1 )
	mv ${v_final1} ${v_final2} ${v_project_dir}/${catalog_type}/sample &&
	rm -r ${v_workdir}
	ruby ${meteorImportScript} \
		-i ${v_project_dir}/${catalog_type}/sample \
		-p ${catalog_type} \
		-t ${seq_platform} \
		-m "${sampleId}*" \
	|| return 1
}
function Map_reads {
	ruby ${meteor}/meteor.rb \
		-w ${ini_file} \
		-i ${v_sampledir} \
		-p ${v_project_dir}/${catalog_type} \
		-o mapping \
	|| return 1
}
function Quantify {
	${meteor}/meteor-profiler \
		-p ${v_project_dir}/${catalog_type} \
		-f ${v_project_dir}/${catalog_type}/profiles \
		-t smart_shared_reads \
		-w ${ini_file} \
		-o ${sampleId} ${v_project_dir}/${catalog_type}/mapping/${sampleId}/${sampleId}_${v_prefix}_gene_profile/census.dat \
	&& rm -r ${v_project_dir}/${catalog_type}/mapping/${sampleId} \
	|| return 1
}
function Recover {
	rsync -aurvP --remove-source-files $v_project_dir/ $project_dir_rel
}
function PrepareReports {
	inFile=$v_downstream_dir/$1.csv
	outFile=$v_downstream_dir/$1.final.csv
	cat $v_project_dir/$catalog_type/profiles/*$1.csv > $inFile
	head -1 $inFile > ${outFile}.header
	cat $inFile | grep -v sample > ${outFile}.body
	cat ${outFile}.header ${outFile}.body > ${outFile}
	rm ${inFile} ${outFile}.header ${outFile}.body
}
function PrepareGCT {
	inFile=$v_downstream_dir/merged.tsv
	outFile=$v_downstream_dir/merged.final.tsv
	paste $v_project_dir/$catalog_type/profiles/*.tsv > $inFile
	width=$(head -1 $inFile | awk '{print NF}')
	echo $width
	cat $inFile | cut -f1 | sed 's/\#id_fragment/gene_id/g' > ${outFile}.gene
	cat $inFile | awk -v width="$width" 'BEGIN{OFS="\t"}{s="";for(i=2;i<=width;i=i+2){if (i!=width)s=s $i "\t"; if (i==width) s=s $i}; print s}' > ${outFile}.expr
	paste ${outFile}.gene ${outFile}.expr > ${outFile}
	rm ${inFile} ${outFile}.gene ${outFile}.expr
}
function SaveGCT {
	#cd $v_downstream_dir
	Rscript $Rdir/save.gct.r  \
		$v_downstream_dir/merged.final.tsv \
		merged.final \
		$v_downstream_dir \
	|| return 1
}
function Normalize {
	#cd $v_downstream_dir
	Rscript $Rdir/get.norm.downsize.r \
		$v_downstream_dir/merged.final.RData \
		merged.final \
		$v_downstream_dir \
		$v_downstream_dir \
	|| return 1
}
function GetMGS {
	Rscript $Rdir/get.oral.mgs.from.norm.r \
		$v_downstream_dir/merged.final.norm.10M.RData \
		merged.final \
		$v_downstream_dir \
		$v_downstream_dir \
	|| return 1
}

Main() {
	sampleId=$(basename $1 .fastq.gz)
	fastqgzs+=("$2")
	fastqgzs+=("$3")

	Run Parse_variables &&
	Run Init &&
	Run Send &&
	Run Decompress &&
	Run Trim &&
	Run Import &&
	Run Map_reads &&
	Run Quantify &&
	Run Recover
}
Downstream() {
	v_project_dir=$(readlink -f $project_dir_rel)
	v_downstream_dir="$v_project_dir/Downstream"
	mkdir -p $v_downstream_dir

	Run PrepareReports counting_report &&
	Run PrepareReports extended_counting_report &&
	Run PrepareGCT &&
	Run SaveGCT &&
	Run Normalize &&
	Run GetMGS 
}

echo "...$(date): - begin running script"
cat $0
echo ""

# Load modules
echo "...$(date): - load modules"
module load bioinfo-tools
module load ruby/2.6.2
module load AlienTrimmer/0.4.0
module load bowtie2/2.3.4.1
echo "...$(date): - done; echo ''"

# Load ini file
echo "...$(date): - load ini file"
sed -i "s|meteor.reference.dir=.*|meteor.reference.dir=$TMPDIR/reference|g" $1
ini_file=$1
source $ini_file > /dev/null 2>&1
v_prefix=$( grep "meteor.counting.prefix.name" $ini_file | sed "s/^.*=//g" )
cat $ini_file
echo "...$(date): - done; echo ''"

# Run meteor
Main $sample $seq_data_dir/${sample}${forward_identifier} $seq_data_dir/${sample}${reverse_identifier}

# Run the downstream analysis
#Downstream

...Tue Jun  8 19:20:54 CEST 2021: - load modules
Bowtie2 looks for the specified index first in the current directory, then in the directory specified in the BOWTIE2_INDEXES environment variable.
The pregenerated indexes for the reference genonomes are placed under /sw/data/reference/*/*/program_files/bowtie2 for each reference genome
...Tue Jun  8 19:21:01 CEST 2021: - done; echo ''
...Tue Jun  8 19:21:01 CEST 2021: - load ini file
[Pipeline]
sample="P18161_280/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_280_S147_L004"
forward_identifier="_R1_001.fastq.gz"
reverse_identifier="_R2_001.fastq.gz"
seq_data_dir="/proj/snic2020-6-153/delivery04021/P18161"
project_dir_rel="/proj/uppstore2019028/projects/metagenome/theo/newscripts/tmp"
catalog_type="oral_catalog"
seq_platform="illumina"
trimFasta="/proj/uppstore2019028/projects/metagenome/alienTrimmerPF8contaminants.fasta"
meteorImportScript="/proj/uppstore2019028/meteor.2019.11.04/MeteorImportFastq.rb"
meteor="/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04"
Rdir="/proj/uppstore2019028/projects/metagenome/meteor_downstream_rscripts"
reference_dir="/proj/uppstore2019028/projects/metagenome/meteor_ref"
[worksession]
meteor.reference.dir=/scratch/20383274/reference
meteor.db.type=binary
meteor.nb.attempts=3
meteor.read.cleaning.program=none
meteor.read.cleaning.cmd=
meteor.mapping.program=bowtie2
meteor.mapping.file.format=sam
meteor.is.cpu.percentage=0
meteor.cpu.count=10
meteor.checksum=md5
meteor.excluded.reference.count=3
[main_reference]
meteor.reference.name=oral_catalog
meteor.matches=10000
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapper.cmd=
meteor.mapping.prefix.name=mapping_vs_oral_catalog
meteor.counting.prefix.name=vs_hs_10_4_oral_catalog
[excluded_reference_1]
meteor.reference.name=Homo_sapiens_GRCh38
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_Homo_sapiens_GRCh38
[excluded_reference_2]
meteor.reference.name=A_thaliana_TAIR10
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_A_thaliana_TAIR10
[excluded_reference_3]
meteor.reference.name=Bos_taurus_UMD3
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_Bos_taurus_UMD3
...Tue Jun  8 19:21:01 CEST 2021: - done; echo ''
...Tue Jun  8 19:21:01 CEST 2021: Parse_variables - begin
v_downstream_dir=/scratch/20383274/P18161_280_S147_L004/Downstream
v_fastqgz1=/crex/proj/snic2020-6-153/nobackup/delivery04021/P18161/P18161_280/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_280_S147_L004_R1_001.fastq.gz
v_fastqgz1_unzip=/scratch/20383274/P18161_280_S147_L004/working/P18161_280_S147_L004/P18161_280_S147_L004_R1_001.fastq.unzipped
v_fastqgz2=/crex/proj/snic2020-6-153/nobackup/delivery04021/P18161/P18161_280/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_280_S147_L004_R2_001.fastq.gz
v_fastqgz2_unzip=/scratch/20383274/P18161_280_S147_L004/working/P18161_280_S147_L004/P18161_280_S147_L004_R2_001.fastq.unzipped
v_final1=/scratch/20383274/P18161_280_S147_L004/working/P18161_280_S147_L004/P18161_280_S147_L004_1.fastq
v_final2=/scratch/20383274/P18161_280_S147_L004/working/P18161_280_S147_L004/P18161_280_S147_L004_2.fastq
v_prefix=vs_hs_10_4_oral_catalog
v_project_dir=/scratch/20383274/P18161_280_S147_L004
v_sampledir=/scratch/20383274/P18161_280_S147_L004/oral_catalog/sample/P18161_280_S147_L004
v_trimmedS=/scratch/20383274/P18161_280_S147_L004/working/P18161_280_S147_L004/P18161_280_S147_L004.trimmed.s.fastq
v_workdir=/scratch/20383274/P18161_280_S147_L004/working/P18161_280_S147_L004
...Tue Jun  8 19:21:01 CEST 2021: Parse_variables - done

...Tue Jun  8 19:21:01 CEST 2021: Init - begin
...Tue Jun  8 19:21:01 CEST 2021: Init - done

...Tue Jun  8 19:21:01 CEST 2021: Send - begin
...Tue Jun  8 19:26:29 CEST 2021: Send - done

...Tue Jun  8 19:26:29 CEST 2021: Decompress - begin
...Tue Jun  8 19:36:11 CEST 2021: Decompress - done

...Tue Jun  8 19:36:11 CEST 2021: Trim - begin
AlienTrimmer main options: -k 10 -l 45 -m 5 -q 20 -p 40 (Phred+33)  /  439 fwd alien sequence(s)  /  7856 fwd k-mers (k=10)  /  439 rev alien sequence(s)  /  7856 rev k-mers (k=10)
[01:55]   1,000,000 read pairs processed:     647,596 trimmed (fwd:     307,536  rev:     340,060)      12,219 removed (fwd:       4,828  rev:       7,391)
[03:52]   2,000,000 read pairs processed:   1,272,903 trimmed (fwd:     600,604  rev:     672,299)      23,743 removed (fwd:       9,245  rev:      14,498)
[05:49]   3,000,000 read pairs processed:   1,906,709 trimmed (fwd:     894,958  rev:   1,011,751)      35,145 removed (fwd:      13,506  rev:      21,639)
[07:46]   4,000,000 read pairs processed:   2,545,596 trimmed (fwd:   1,186,905  rev:   1,358,691)      46,539 removed (fwd:      17,464  rev:      29,075)
[09:45]   5,000,000 read pairs processed:   3,177,310 trimmed (fwd:   1,472,671  rev:   1,704,639)      57,799 removed (fwd:      21,277  rev:      36,522)
[11:44]   6,000,000 read pairs processed:   3,815,259 trimmed (fwd:   1,771,992  rev:   2,043,267)      69,665 removed (fwd:      25,665  rev:      44,000)
[13:42]   7,000,000 read pairs processed:   4,440,930 trimmed (fwd:   2,064,826  rev:   2,376,104)      80,970 removed (fwd:      29,902  rev:      51,068)
[15:42]   8,000,000 read pairs processed:   5,061,822 trimmed (fwd:   2,353,042  rev:   2,708,780)      92,014 removed (fwd:      34,030  rev:      57,984)
[17:40]   9,000,000 read pairs processed:   5,686,466 trimmed (fwd:   2,640,968  rev:   3,045,498)     103,052 removed (fwd:      38,048  rev:      65,004)
[19:41]  10,000,000 read pairs processed:   6,315,936 trimmed (fwd:   2,927,329  rev:   3,388,607)     114,269 removed (fwd:      41,857  rev:      72,412)
[21:41]  11,000,000 read pairs processed:   6,956,594 trimmed (fwd:   3,221,201  rev:   3,735,393)     125,924 removed (fwd:      45,882  rev:      80,042)
[23:40]  12,000,000 read pairs processed:   7,588,166 trimmed (fwd:   3,517,102  rev:   4,071,064)     137,154 removed (fwd:      50,116  rev:      87,038)
[25:39]  13,000,000 read pairs processed:   8,202,619 trimmed (fwd:   3,803,760  rev:   4,398,859)     147,806 removed (fwd:      54,061  rev:      93,745)
[27:39]  14,000,000 read pairs processed:   8,824,908 trimmed (fwd:   4,090,561  rev:   4,734,347)     158,660 removed (fwd:      58,077  rev:     100,583)
[29:37]  15,000,000 read pairs processed:   9,455,915 trimmed (fwd:   4,377,358  rev:   5,078,557)     169,508 removed (fwd:      61,793  rev:     107,715)
[31:35]  16,000,000 read pairs processed:  10,094,669 trimmed (fwd:   4,665,745  rev:   5,428,924)     180,666 removed (fwd:      65,447  rev:     115,219)
[33:34]  17,000,000 read pairs processed:  10,709,577 trimmed (fwd:   4,955,047  rev:   5,754,530)     191,701 removed (fwd:      69,622  rev:     122,079)
[35:30]  18,000,000 read pairs processed:  11,320,748 trimmed (fwd:   5,239,202  rev:   6,081,546)     202,181 removed (fwd:      73,508  rev:     128,673)
[37:31]  19,000,000 read pairs processed:  11,935,083 trimmed (fwd:   5,523,308  rev:   6,411,775)     212,853 removed (fwd:      77,343  rev:     135,510)
[39:30]  20,000,000 read pairs processed:  12,551,436 trimmed (fwd:   5,806,373  rev:   6,745,063)     223,549 removed (fwd:      81,176  rev:     142,373)
[41:31]  21,000,000 read pairs processed:  13,176,442 trimmed (fwd:   6,091,067  rev:   7,085,375)     234,409 removed (fwd:      84,864  rev:     149,545)
[43:33]  22,000,000 read pairs processed:  13,811,306 trimmed (fwd:   6,384,202  rev:   7,427,104)     245,513 removed (fwd:      88,835  rev:     156,678)
[45:30]  23,000,000 read pairs processed:  14,428,618 trimmed (fwd:   6,669,706  rev:   7,758,912)     256,126 removed (fwd:      92,675  rev:     163,451)
[47:27]  24,000,000 read pairs processed:  15,049,392 trimmed (fwd:   6,954,590  rev:   8,094,802)     266,798 removed (fwd:      96,545  rev:     170,253)
[49:27]  25,000,000 read pairs processed:  15,671,126 trimmed (fwd:   7,238,416  rev:   8,432,710)     277,539 removed (fwd:     100,473  rev:     177,066)
[51:29]  26,000,000 read pairs processed:  16,294,750 trimmed (fwd:   7,522,613  rev:   8,772,137)     288,067 removed (fwd:     104,133  rev:     183,934)
[53:30]  27,000,000 read pairs processed:  16,921,359 trimmed (fwd:   7,810,858  rev:   9,110,501)     298,949 removed (fwd:     107,997  rev:     190,952)
[55:29]  28,000,000 read pairs processed:  17,543,172 trimmed (fwd:   8,107,735  rev:   9,435,437)     310,552 removed (fwd:     112,592  rev:     197,960)
[57:28]  29,000,000 read pairs processed:  18,159,277 trimmed (fwd:   8,398,382  rev:   9,760,895)     321,921 removed (fwd:     116,947  rev:     204,974)
[59:25]  30,000,000 read pairs processed:  18,767,934 trimmed (fwd:   8,684,501  rev:  10,083,433)     333,053 removed (fwd:     121,234  rev:     211,819)
[61:23]  31,000,000 read pairs processed:  19,373,781 trimmed (fwd:   8,966,386  rev:  10,407,395)     343,908 removed (fwd:     125,181  rev:     218,727)
[63:26]  32,000,000 read pairs processed:  19,992,601 trimmed (fwd:   9,251,650  rev:  10,740,951)     354,205 removed (fwd:     128,755  rev:     225,450)
[65:27]  33,000,000 read pairs processed:  20,775,837 trimmed (fwd:   9,612,073  rev:  11,163,764)     368,111 removed (fwd:     133,052  rev:     235,059)
[67:26]  34,000,000 read pairs processed:  21,552,688 trimmed (fwd:   9,968,814  rev:  11,583,874)     383,685 removed (fwd:     137,570  rev:     246,115)
[69:27]  35,000,000 read pairs processed:  22,273,557 trimmed (fwd:  10,302,303  rev:  11,971,254)     398,372 removed (fwd:     142,368  rev:     256,004)
[71:28]  36,000,000 read pairs processed:  22,952,713 trimmed (fwd:  10,616,470  rev:  12,336,243)     410,363 removed (fwd:     146,990  rev:     263,373)
[73:28]  37,000,000 read pairs processed:  23,622,331 trimmed (fwd:  10,923,392  rev:  12,698,939)     422,103 removed (fwd:     151,227  rev:     270,876)
[75:30]  38,000,000 read pairs processed:  24,363,305 trimmed (fwd:  11,263,615  rev:  13,099,690)     434,458 removed (fwd:     155,605  rev:     278,853)
[77:31]  39,000,000 read pairs processed:  25,096,515 trimmed (fwd:  11,596,703  rev:  13,499,812)     446,877 removed (fwd:     160,078  rev:     286,799)
[79:30]  40,000,000 read pairs processed:  25,795,026 trimmed (fwd:  11,915,027  rev:  13,879,999)     459,139 removed (fwd:     164,634  rev:     294,505)
[81:28]  41,000,000 read pairs processed:  26,475,169 trimmed (fwd:  12,223,130  rev:  14,252,039)     471,277 removed (fwd:     169,116  rev:     302,161)
[83:28]  42,000,000 read pairs processed:  27,144,771 trimmed (fwd:  12,525,981  rev:  14,618,790)     483,087 removed (fwd:     173,382  rev:     309,705)
[85:29]  43,000,000 read pairs processed:  27,837,412 trimmed (fwd:  12,847,383  rev:  14,990,029)     494,965 removed (fwd:     177,723  rev:     317,242)
[87:29]  44,000,000 read pairs processed:  28,530,886 trimmed (fwd:  13,169,263  rev:  15,361,623)     507,180 removed (fwd:     182,215  rev:     324,965)
[89:28]  45,000,000 read pairs processed:  29,215,829 trimmed (fwd:  13,484,493  rev:  15,731,336)     519,483 removed (fwd:     186,979  rev:     332,504)
[91:26]  46,000,000 read pairs processed:  29,885,734 trimmed (fwd:  13,793,047  rev:  16,092,687)     531,254 removed (fwd:     191,396  rev:     339,858)
[93:28]  47,000,000 read pairs processed:  30,546,380 trimmed (fwd:  14,093,921  rev:  16,452,459)     542,830 removed (fwd:     195,542  rev:     347,288)
[95:27]  48,000,000 read pairs processed:  31,219,418 trimmed (fwd:  14,401,999  rev:  16,817,419)     554,339 removed (fwd:     199,816  rev:     354,523)
[97:25]  49,000,000 read pairs processed:  31,889,636 trimmed (fwd:  14,711,313  rev:  17,178,323)     565,981 removed (fwd:     204,218  rev:     361,763)
[99:23]  50,000,000 read pairs processed:  32,557,753 trimmed (fwd:  15,017,149  rev:  17,540,604)     577,438 removed (fwd:     208,596  rev:     368,842)
[101:23]  51,000,000 read pairs processed:  33,224,523 trimmed (fwd:  15,321,592  rev:  17,902,931)     589,049 removed (fwd:     213,039  rev:     376,010)
[103:23]  52,000,000 read pairs processed:  33,882,083 trimmed (fwd:  15,619,514  rev:  18,262,569)     600,223 removed (fwd:     217,203  rev:     383,020)
[105:21]  53,000,000 read pairs processed:  34,550,396 trimmed (fwd:  15,925,999  rev:  18,624,397)     611,583 removed (fwd:     221,303  rev:     390,280)
[107:20]  54,000,000 read pairs processed:  35,226,706 trimmed (fwd:  16,240,954  rev:  18,985,752)     623,243 removed (fwd:     225,609  rev:     397,634)
[109:19]  55,000,000 read pairs processed:  35,893,809 trimmed (fwd:  16,549,274  rev:  19,344,535)     635,268 removed (fwd:     230,131  rev:     405,137)
[111:18]  56,000,000 read pairs processed:  36,562,064 trimmed (fwd:  16,858,265  rev:  19,703,799)     647,258 removed (fwd:     234,692  rev:     412,566)
[113:21]  57,000,000 read pairs processed:  37,222,705 trimmed (fwd:  17,161,400  rev:  20,061,305)     658,444 removed (fwd:     238,778  rev:     419,666)
[115:22]  58,000,000 read pairs processed:  37,899,050 trimmed (fwd:  17,471,112  rev:  20,427,938)     670,026 removed (fwd:     242,913  rev:     427,113)
[118:55]  59,000,000 read pairs processed:  38,627,758 trimmed (fwd:  17,810,247  rev:  20,817,511)     683,150 removed (fwd:     248,076  rev:     435,074)
[120:53]  60,000,000 read pairs processed:  39,321,094 trimmed (fwd:  18,130,645  rev:  21,190,449)     695,728 removed (fwd:     252,936  rev:     442,792)
[122:54]  61,000,000 read pairs processed:  40,002,254 trimmed (fwd:  18,445,519  rev:  21,556,735)     707,974 removed (fwd:     257,824  rev:     450,150)
[124:54]  62,000,000 read pairs processed:  40,671,249 trimmed (fwd:  18,751,616  rev:  21,919,633)     719,621 removed (fwd:     262,231  rev:     457,390)
[126:39]  62,887,884 read pairs processed:  41,255,472 trimmed (fwd:  19,017,906  rev:  22,237,566)     729,496 removed (fwd:     265,935  rev:     463,561)
...Tue Jun  8 21:42:53 CEST 2021: Trim - done

...Tue Jun  8 21:42:53 CEST 2021: Import - begin
ruby: warning: shebang line ending with \r may cause problems
Import /scratch/20383274/P18161_280_S147_L004/oral_catalog/sample/P18161_280_S147_L004_1.fastq
Import /scratch/20383274/P18161_280_S147_L004/oral_catalog/sample/P18161_280_S147_L004_2.fastq
Importation done!
...Tue Jun  8 21:42:58 CEST 2021: Import - done

...Tue Jun  8 21:42:58 CEST 2021: Map_reads - begin
/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04/meteor.rb:146: warning: constant ::Fixnum is deprecated
/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04/meteor.rb:161: warning: Insecure world writable dir /proj/uppstore2019028/Helen/meteor-linux.2019-11-04 in PATH, mode 042777

Launch mapping


######### Meteor Mapping task description
Sample name = P18161_280_S147_L004
Library name = P18161_280_S147_L004_1
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_280_S147_L004.ini

######### Task main mapping 0
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 10000 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20383274/reference/oral_catalog/fasta/oral_catalog_dnaspace_index -U /scratch/20383274/P18161_280_S147_L004/oral_catalog/sample/P18161_280_S147_L004/ae159d11b67d28bf0eba5d3e87eef9c6/P18161_280_S147_L004_1.fastq.idx -S /scratch/20383274/P18161_280_S147_L004/oral_catalog/mapping/P18161_280_S147_L004/mapping_vs_oral_catalog_P18161_280_S147_L004_1/P18161_280_S147_L004_1_1.sam
