...Sat Jun  5 23:17:41 CEST 2021: - begin running script
#!/bin/bash -l
#SBATCH --account=snic2021-5-248
#SBATCH --partition=core
#SBATCH --ntasks=10
#SBATCH --time=2-00:00:00
#SBATCH --job-name=anotherbatch
#SBATCH --mail-user=zn.tportlock@gmail.com
#SBATCH --mail-type=ALL
##SBATCH --output=/proj/uppstore2019028/projects/metagenome/theo/newscripts/meteor/logs/%j 

set -a

function Run {
	echo "...$(date): $1 - begin"
	$@ \
	&& (echo "...$(date): $1 - done"; echo "") \
	|| (echo "...$(date): $1 - failed"; echo ""; exit 1)
}
function Parse_variables {
	v_project_dir=$TMPDIR/$sampleId
	v_workdir="${v_project_dir}/working/$sampleId"
	v_fastqgz1=$(readlink -f ${fastqgzs[0]})
	v_fastqgz2=$(readlink -f ${fastqgzs[1]})
	v_fastqgz1_unzip="${v_workdir}/$(basename $v_fastqgz1 .gz).unzipped"
	v_fastqgz2_unzip="${v_workdir}/$(basename $v_fastqgz2 .gz).unzipped"
	v_trimmedS="${v_workdir}/${sampleId}.trimmed.s.fastq"
	v_final1="${v_workdir}/${sampleId}_1.fastq"
	v_final2="${v_workdir}/${sampleId}_2.fastq"
	v_sampledir=${v_project_dir}/${catalog_type}/sample/${sampleId}
	v_downstream_dir="$v_project_dir/Downstream"
	vars=$(compgen -A variable | grep "^v_.*")
	for var in ${vars}; do echo "${var}=${!var}"; done
	for var in ${vars}; do if [[ -z "${!var}" ]]; then echo "missing argument ${var}" ; return 1 ; fi ; done
}
function Init {
	mkdir -p ${v_project_dir}/${catalog_type}/{sample,mapping,profiles}
	mkdir -p $TMPDIR/reference
	mkdir -p ${v_workdir}
}
function Send {
	cp $v_fastqgz1 ${v_workdir}
	cp $v_fastqgz2 ${v_workdir}
	cp -r ${reference_dir}/* $TMPDIR/reference
	cp -r ${trimFasta} $TMPDIR
}
function Decompress {
	zcat ${v_workdir}/$(basename $v_fastqgz1) > $v_fastqgz1_unzip & pid1=$!
	zcat ${v_workdir}/$(basename $v_fastqgz2) > $v_fastqgz2_unzip & pid2=$!
	trap "kill -2 $pid1 $pid2" SIGINT
	wait
}
function Trim {
	[[ -f $v_fastqgz1_unzip && -f $v_fastqgz2_unzip ]] \
	|| (echo "zip file not found" ; return 1 )
	java -jar ${ALIEN_TRIMMER}/AlienTrimmer.jar \
		-k 10 -l 45 -m 5 -p 40 -q 20 \
		-if ${v_fastqgz1_unzip} -ir ${v_fastqgz2_unzip} -c $TMPDIR/$(basename $trimFasta) \
		-of ${v_final1} -or ${v_final2} -os ${v_trimmedS} \
	|| return 1
}
function Import {
	[[ -f $v_final1 && -f $v_final2 ]] \
	|| (echo "trimmed files not found" ; return 1 )
	mv ${v_final1} ${v_final2} ${v_project_dir}/${catalog_type}/sample &&
	rm -r ${v_workdir}
	ruby ${meteorImportScript} \
		-i ${v_project_dir}/${catalog_type}/sample \
		-p ${catalog_type} \
		-t ${seq_platform} \
		-m "${sampleId}*" \
	|| return 1
}
function Map_reads {
	ruby ${meteor}/meteor.rb \
		-w ${ini_file} \
		-i ${v_sampledir} \
		-p ${v_project_dir}/${catalog_type} \
		-o mapping \
	|| return 1
}
function Quantify {
	${meteor}/meteor-profiler \
		-p ${v_project_dir}/${catalog_type} \
		-f ${v_project_dir}/${catalog_type}/profiles \
		-t smart_shared_reads \
		-w ${ini_file} \
		-o ${sampleId} ${v_project_dir}/${catalog_type}/mapping/${sampleId}/${sampleId}_${v_prefix}_gene_profile/census.dat \
	&& rm -r ${v_project_dir}/${catalog_type}/mapping/${sampleId} \
	|| return 1
}
function Recover {
	rsync -aurvP --remove-source-files $v_project_dir/ $project_dir_rel
}
function PrepareReports {
	inFile=$v_downstream_dir/$1.csv
	outFile=$v_downstream_dir/$1.final.csv
	cat $v_project_dir/$catalog_type/profiles/*$1.csv > $inFile
	head -1 $inFile > ${outFile}.header
	cat $inFile | grep -v sample > ${outFile}.body
	cat ${outFile}.header ${outFile}.body > ${outFile}
	rm ${inFile} ${outFile}.header ${outFile}.body
}
function PrepareGCT {
	inFile=$v_downstream_dir/merged.tsv
	outFile=$v_downstream_dir/merged.final.tsv
	paste $v_project_dir/$catalog_type/profiles/*.tsv > $inFile
	width=$(head -1 $inFile | awk '{print NF}')
	echo $width
	cat $inFile | cut -f1 | sed 's/\#id_fragment/gene_id/g' > ${outFile}.gene
	cat $inFile | awk -v width="$width" 'BEGIN{OFS="\t"}{s="";for(i=2;i<=width;i=i+2){if (i!=width)s=s $i "\t"; if (i==width) s=s $i}; print s}' > ${outFile}.expr
	paste ${outFile}.gene ${outFile}.expr > ${outFile}
	rm ${inFile} ${outFile}.gene ${outFile}.expr
}
function SaveGCT {
	#cd $v_downstream_dir
	Rscript $Rdir/save.gct.r  \
		$v_downstream_dir/merged.final.tsv \
		merged.final \
		$v_downstream_dir \
	|| return 1
}
function Normalize {
	#cd $v_downstream_dir
	Rscript $Rdir/get.norm.downsize.r \
		$v_downstream_dir/merged.final.RData \
		merged.final \
		$v_downstream_dir \
		$v_downstream_dir \
	|| return 1
}
function GetMGS {
	Rscript $Rdir/get.oral.mgs.from.norm.r \
		$v_downstream_dir/merged.final.norm.10M.RData \
		merged.final \
		$v_downstream_dir \
		$v_downstream_dir \
	|| return 1
}

Main() {
	sampleId=$(basename $1 .fastq.gz)
	fastqgzs+=("$2")
	fastqgzs+=("$3")

	Run Parse_variables &&
	Run Init &&
	Run Send &&
	Run Decompress &&
	Run Trim &&
	Run Import &&
	Run Map_reads &&
	Run Quantify &&
	Run Recover
}
Downstream() {
	v_project_dir=$(readlink -f $project_dir_rel)
	v_downstream_dir="$v_project_dir/Downstream"
	mkdir -p $v_downstream_dir

	Run PrepareReports counting_report &&
	Run PrepareReports extended_counting_report &&
	Run PrepareGCT &&
	Run SaveGCT &&
	Run Normalize &&
	Run GetMGS 
}

echo "...$(date): - begin running script"
cat $0
echo ""

# Load modules
echo "...$(date): - load modules"
module load bioinfo-tools
module load ruby/2.6.2
module load AlienTrimmer/0.4.0
module load bowtie2/2.3.4.1
echo "...$(date): - done; echo ''"

# Load ini file
echo "...$(date): - load ini file"
sed -i "s|meteor.reference.dir=.*|meteor.reference.dir=$TMPDIR/reference|g" $1
ini_file=$1
source $ini_file > /dev/null 2>&1
v_prefix=$( grep "meteor.counting.prefix.name" $ini_file | sed "s/^.*=//g" )
cat $ini_file
echo "...$(date): - done; echo ''"

# Run meteor
Main $sample $seq_data_dir/${sample}${forward_identifier} $seq_data_dir/${sample}${reverse_identifier}

# Run the downstream analysis
#Downstream

...Sat Jun  5 23:17:42 CEST 2021: - load modules
Bowtie2 looks for the specified index first in the current directory, then in the directory specified in the BOWTIE2_INDEXES environment variable.
The pregenerated indexes for the reference genonomes are placed under /sw/data/reference/*/*/program_files/bowtie2 for each reference genome
...Sat Jun  5 23:17:49 CEST 2021: - done; echo ''
...Sat Jun  5 23:17:49 CEST 2021: - load ini file
[Pipeline]
sample=P18161_217/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_217_S90_L004
forward_identifier="_R1_001.fastq.gz"
reverse_identifier="_R2_001.fastq.gz"
seq_data_dir="/proj/snic2020-6-153/delivery04021/P18161"
project_dir_rel="/proj/uppstore2019028/projects/metagenome/theo/newscripts/tmp"
catalog_type="oral_catalog"
seq_platform="illumina"
trimFasta="/proj/uppstore2019028/projects/metagenome/alienTrimmerPF8contaminants.fasta"
meteorImportScript="/proj/uppstore2019028/meteor.2019.11.04/MeteorImportFastq.rb"
meteor="/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04"
Rdir="/proj/uppstore2019028/projects/metagenome/meteor_downstream_rscripts"
reference_dir="/proj/uppstore2019028/projects/metagenome/meteor_ref"
[worksession]
meteor.reference.dir=/scratch/20349673/reference
meteor.db.type=binary
meteor.nb.attempts=3
meteor.read.cleaning.program=none
meteor.read.cleaning.cmd=
meteor.mapping.program=bowtie2
meteor.mapping.file.format=sam
meteor.is.cpu.percentage=0
meteor.cpu.count=10
meteor.checksum=md5
meteor.excluded.reference.count=3
[main_reference]
meteor.reference.name=oral_catalog
meteor.matches=10000
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapper.cmd=
meteor.mapping.prefix.name=mapping_vs_oral_catalog
meteor.counting.prefix.name=vs_hs_10_4_oral_catalog
[excluded_reference_1]
meteor.reference.name=Homo_sapiens_GRCh38
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_Homo_sapiens_GRCh38
[excluded_reference_2]
meteor.reference.name=A_thaliana_TAIR10
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_A_thaliana_TAIR10
[excluded_reference_3]
meteor.reference.name=Bos_taurus_UMD3
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_Bos_taurus_UMD3
...Sat Jun  5 23:17:49 CEST 2021: - done; echo ''
...Sat Jun  5 23:17:49 CEST 2021: Parse_variables - begin
v_downstream_dir=/scratch/20349673/P18161_217_S90_L004/Downstream
v_fastqgz1=/crex/proj/snic2020-6-153/nobackup/delivery04021/P18161/P18161_217/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_217_S90_L004_R1_001.fastq.gz
v_fastqgz1_unzip=/scratch/20349673/P18161_217_S90_L004/working/P18161_217_S90_L004/P18161_217_S90_L004_R1_001.fastq.unzipped
v_fastqgz2=/crex/proj/snic2020-6-153/nobackup/delivery04021/P18161/P18161_217/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_217_S90_L004_R2_001.fastq.gz
v_fastqgz2_unzip=/scratch/20349673/P18161_217_S90_L004/working/P18161_217_S90_L004/P18161_217_S90_L004_R2_001.fastq.unzipped
v_final1=/scratch/20349673/P18161_217_S90_L004/working/P18161_217_S90_L004/P18161_217_S90_L004_1.fastq
v_final2=/scratch/20349673/P18161_217_S90_L004/working/P18161_217_S90_L004/P18161_217_S90_L004_2.fastq
v_prefix=vs_hs_10_4_oral_catalog
v_project_dir=/scratch/20349673/P18161_217_S90_L004
v_sampledir=/scratch/20349673/P18161_217_S90_L004/oral_catalog/sample/P18161_217_S90_L004
v_trimmedS=/scratch/20349673/P18161_217_S90_L004/working/P18161_217_S90_L004/P18161_217_S90_L004.trimmed.s.fastq
v_workdir=/scratch/20349673/P18161_217_S90_L004/working/P18161_217_S90_L004
...Sat Jun  5 23:17:49 CEST 2021: Parse_variables - done

...Sat Jun  5 23:17:49 CEST 2021: Init - begin
...Sat Jun  5 23:17:49 CEST 2021: Init - done

...Sat Jun  5 23:17:49 CEST 2021: Send - begin
...Sun Jun  6 00:35:20 CEST 2021: Send - done

...Sun Jun  6 00:35:20 CEST 2021: Decompress - begin
...Sun Jun  6 00:44:50 CEST 2021: Decompress - done

...Sun Jun  6 00:44:50 CEST 2021: Trim - begin
AlienTrimmer main options: -k 10 -l 45 -m 5 -q 20 -p 40 (Phred+33)  /  439 fwd alien sequence(s)  /  7856 fwd k-mers (k=10)  /  439 rev alien sequence(s)  /  7856 rev k-mers (k=10)
[01:53]   1,000,000 read pairs processed:     650,982 trimmed (fwd:     304,970  rev:     346,012)      14,076 removed (fwd:       4,447  rev:       9,629)
[03:46]   2,000,000 read pairs processed:   1,305,270 trimmed (fwd:     605,328  rev:     699,942)      28,411 removed (fwd:       8,678  rev:      19,733)
[05:40]   3,000,000 read pairs processed:   1,960,260 trimmed (fwd:     901,053  rev:   1,059,207)      43,678 removed (fwd:      12,556  rev:      31,122)
[07:33]   4,000,000 read pairs processed:   2,602,906 trimmed (fwd:   1,201,111  rev:   1,401,795)      57,104 removed (fwd:      16,926  rev:      40,178)
[09:27]   5,000,000 read pairs processed:   3,247,929 trimmed (fwd:   1,496,974  rev:   1,750,955)      70,756 removed (fwd:      20,982  rev:      49,774)
[11:22]   6,000,000 read pairs processed:   3,903,096 trimmed (fwd:   1,792,953  rev:   2,110,143)      85,697 removed (fwd:      24,869  rev:      60,828)
[13:16]   7,000,000 read pairs processed:   4,544,801 trimmed (fwd:   2,091,013  rev:   2,453,788)      99,054 removed (fwd:      29,027  rev:      70,027)
[15:10]   8,000,000 read pairs processed:   5,191,596 trimmed (fwd:   2,385,602  rev:   2,805,994)     113,088 removed (fwd:      33,001  rev:      80,087)
[17:06]   9,000,000 read pairs processed:   5,841,351 trimmed (fwd:   2,679,228  rev:   3,162,123)     127,344 removed (fwd:      36,672  rev:      90,672)
[18:58]  10,000,000 read pairs processed:   6,470,201 trimmed (fwd:   2,968,948  rev:   3,501,253)     140,221 removed (fwd:      40,553  rev:      99,668)
[20:51]  11,000,000 read pairs processed:   7,108,169 trimmed (fwd:   3,260,047  rev:   3,848,122)     153,667 removed (fwd:      44,399  rev:     109,268)
[22:46]  12,000,000 read pairs processed:   7,756,525 trimmed (fwd:   3,553,573  rev:   4,202,952)     167,412 removed (fwd:      48,117  rev:     119,295)
[24:39]  13,000,000 read pairs processed:   8,395,135 trimmed (fwd:   3,846,059  rev:   4,549,076)     180,201 removed (fwd:      52,063  rev:     128,138)
[26:32]  14,000,000 read pairs processed:   9,040,340 trimmed (fwd:   4,137,711  rev:   4,902,629)     193,488 removed (fwd:      55,983  rev:     137,505)
[28:27]  15,000,000 read pairs processed:   9,686,189 trimmed (fwd:   4,431,214  rev:   5,254,975)     206,607 removed (fwd:      59,711  rev:     146,896)
[30:19]  16,000,000 read pairs processed:  10,319,007 trimmed (fwd:   4,727,094  rev:   5,591,913)     219,916 removed (fwd:      63,975  rev:     155,941)
[32:11]  17,000,000 read pairs processed:  10,944,409 trimmed (fwd:   5,016,010  rev:   5,928,399)     233,209 removed (fwd:      68,137  rev:     165,072)
[34:06]  18,000,000 read pairs processed:  11,627,347 trimmed (fwd:   5,328,547  rev:   6,298,800)     247,131 removed (fwd:      71,953  rev:     175,178)
[36:00]  19,000,000 read pairs processed:  12,407,584 trimmed (fwd:   5,688,176  rev:   6,719,408)     263,466 removed (fwd:      76,097  rev:     187,369)
[37:55]  20,000,000 read pairs processed:  13,102,046 trimmed (fwd:   6,008,412  rev:   7,093,634)     276,528 removed (fwd:      80,295  rev:     196,233)
[39:51]  21,000,000 read pairs processed:  13,841,209 trimmed (fwd:   6,346,983  rev:   7,494,226)     290,497 removed (fwd:      84,379  rev:     206,118)
[41:44]  22,000,000 read pairs processed:  14,564,425 trimmed (fwd:   6,676,265  rev:   7,888,160)     303,843 removed (fwd:      88,464  rev:     215,379)
[43:37]  23,000,000 read pairs processed:  15,251,945 trimmed (fwd:   6,986,187  rev:   8,265,758)     317,039 removed (fwd:      92,370  rev:     224,669)
[45:31]  24,000,000 read pairs processed:  15,963,651 trimmed (fwd:   7,316,399  rev:   8,647,252)     329,815 removed (fwd:      96,507  rev:     233,308)
[47:25]  25,000,000 read pairs processed:  16,652,936 trimmed (fwd:   7,632,555  rev:   9,020,381)     342,356 removed (fwd:     100,683  rev:     241,673)
[49:20]  26,000,000 read pairs processed:  17,332,177 trimmed (fwd:   7,940,761  rev:   9,391,416)     354,913 removed (fwd:     104,623  rev:     250,290)
[51:15]  27,000,000 read pairs processed:  18,015,788 trimmed (fwd:   8,254,235  rev:   9,761,553)     367,147 removed (fwd:     108,799  rev:     258,348)
[53:13]  28,000,000 read pairs processed:  18,694,281 trimmed (fwd:   8,561,775  rev:  10,132,506)     379,274 removed (fwd:     112,703  rev:     266,571)
[55:15]  29,000,000 read pairs processed:  19,376,978 trimmed (fwd:   8,873,924  rev:  10,503,054)     391,752 removed (fwd:     116,588  rev:     275,164)
[57:32]  30,000,000 read pairs processed:  20,061,858 trimmed (fwd:   9,189,619  rev:  10,872,239)     404,397 removed (fwd:     120,727  rev:     283,670)
[59:51]  31,000,000 read pairs processed:  20,739,563 trimmed (fwd:   9,500,060  rev:  11,239,503)     416,465 removed (fwd:     124,482  rev:     291,983)
[64:26]  32,000,000 read pairs processed:  21,464,066 trimmed (fwd:   9,833,028  rev:  11,631,038)     430,122 removed (fwd:     128,746  rev:     301,376)
[66:55]  33,000,000 read pairs processed:  22,165,287 trimmed (fwd:  10,155,118  rev:  12,010,169)     443,377 removed (fwd:     133,261  rev:     310,116)
[68:44]  33,959,136 read pairs processed:  22,813,023 trimmed (fwd:  10,449,011  rev:  12,364,012)     455,162 removed (fwd:     136,894  rev:     318,268)
...Sun Jun  6 01:53:34 CEST 2021: Trim - done

...Sun Jun  6 01:53:34 CEST 2021: Import - begin
ruby: warning: shebang line ending with \r may cause problems
Import /scratch/20349673/P18161_217_S90_L004/oral_catalog/sample/P18161_217_S90_L004_2.fastq
Import /scratch/20349673/P18161_217_S90_L004/oral_catalog/sample/P18161_217_S90_L004_1.fastq
Importation done!
...Sun Jun  6 01:53:47 CEST 2021: Import - done

...Sun Jun  6 01:53:47 CEST 2021: Map_reads - begin
/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04/meteor.rb:146: warning: constant ::Fixnum is deprecated
/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04/meteor.rb:161: warning: Insecure world writable dir /proj/uppstore2019028/Helen/meteor-linux.2019-11-04 in PATH, mode 042777

Launch mapping


######### Meteor Mapping task description
Sample name = P18161_217_S90_L004
Library name = P18161_217_S90_L004_1
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_217_S90_L004.ini

######### Task main mapping 0
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 10000 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349673/reference/oral_catalog/fasta/oral_catalog_dnaspace_index -U /scratch/20349673/P18161_217_S90_L004/oral_catalog/sample/P18161_217_S90_L004/0daf3062f0eb74ba5ec7070b4476b260/P18161_217_S90_L004_1.fastq.idx -S /scratch/20349673/P18161_217_S90_L004/oral_catalog/mapping/P18161_217_S90_L004/mapping_vs_oral_catalog_P18161_217_S90_L004_1/P18161_217_S90_L004_1_1.sam
33529966 reads; of these:
  33529966 (100.00%) were unpaired; of these:
    26674211 (79.55%) aligned 0 times
    1646262 (4.91%) aligned exactly 1 time
    5209493 (15.54%) aligned >1 times
20.45% overall alignment rate

######### TaskExcludedMapping(0, 1) ; reference name: Homo_sapiens_GRCh38
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349673/reference/Homo_sapiens_GRCh38/fasta/Homo_sapiens_GRCh38_dnaspace_index -U /scratch/20349673/P18161_217_S90_L004/oral_catalog/sample/P18161_217_S90_L004/0daf3062f0eb74ba5ec7070b4476b260/P18161_217_S90_L004_1.fastq.idx -S /scratch/20349673/P18161_217_S90_L004/oral_catalog/mapping/P18161_217_S90_L004/mapping_vs_Homo_sapiens_GRCh38_P18161_217_S90_L004_1/P18161_217_S90_L004_1_1.sam
33529966 reads; of these:
  33529966 (100.00%) were unpaired; of these:
    4807749 (14.34%) aligned 0 times
    28722217 (85.66%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
85.66% overall alignment rate

######### TaskExcludedMapping(0, 2) ; reference name: A_thaliana_TAIR10
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349673/reference/A_thaliana_TAIR10/fasta/A_thaliana_TAIR10_dnaspace_index -U /scratch/20349673/P18161_217_S90_L004/oral_catalog/sample/P18161_217_S90_L004/0daf3062f0eb74ba5ec7070b4476b260/P18161_217_S90_L004_1.fastq.idx -S /scratch/20349673/P18161_217_S90_L004/oral_catalog/mapping/P18161_217_S90_L004/mapping_vs_A_thaliana_TAIR10_P18161_217_S90_L004_1/P18161_217_S90_L004_1_1.sam
33529966 reads; of these:
  33529966 (100.00%) were unpaired; of these:
    33524769 (99.98%) aligned 0 times
    5197 (0.02%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
0.02% overall alignment rate

######### TaskExcludedMapping(0, 3) ; reference name: Bos_taurus_UMD3
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349673/reference/Bos_taurus_UMD3/fasta/Bos_taurus_UMD3_dnaspace_index -U /scratch/20349673/P18161_217_S90_L004/oral_catalog/sample/P18161_217_S90_L004/0daf3062f0eb74ba5ec7070b4476b260/P18161_217_S90_L004_1.fastq.idx -S /scratch/20349673/P18161_217_S90_L004/oral_catalog/mapping/P18161_217_S90_L004/mapping_vs_Bos_taurus_UMD3_P18161_217_S90_L004_1/P18161_217_S90_L004_1_1.sam
33529966 reads; of these:
  33529966 (100.00%) were unpaired; of these:
    33028685 (98.50%) aligned 0 times
    501281 (1.50%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
1.50% overall alignment rate
removing re-indexed file:
/scratch/20349673/P18161_217_S90_L004/oral_catalog/sample/P18161_217_S90_L004/0daf3062f0eb74ba5ec7070b4476b260/P18161_217_S90_L004_1.fastq.idx


######### Meteor Mapping task description
Sample name = P18161_217_S90_L004
Library name = P18161_217_S90_L004_2
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_217_S90_L004.ini

######### Task main mapping 1
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 10000 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349673/reference/oral_catalog/fasta/oral_catalog_dnaspace_index -U /scratch/20349673/P18161_217_S90_L004/oral_catalog/sample/P18161_217_S90_L004/0daf3062f0eb74ba5ec7070b4476b260/P18161_217_S90_L004_2.fastq.idx -S /scratch/20349673/P18161_217_S90_L004/oral_catalog/mapping/P18161_217_S90_L004/mapping_vs_oral_catalog_P18161_217_S90_L004_2/P18161_217_S90_L004_2_1.sam
33529966 reads; of these:
  33529966 (100.00%) were unpaired; of these:
    26783515 (79.88%) aligned 0 times
    1631851 (4.87%) aligned exactly 1 time
    5114600 (15.25%) aligned >1 times
20.12% overall alignment rate

######### TaskExcludedMapping(1, 1) ; reference name: Homo_sapiens_GRCh38
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349673/reference/Homo_sapiens_GRCh38/fasta/Homo_sapiens_GRCh38_dnaspace_index -U /scratch/20349673/P18161_217_S90_L004/oral_catalog/sample/P18161_217_S90_L004/0daf3062f0eb74ba5ec7070b4476b260/P18161_217_S90_L004_2.fastq.idx -S /scratch/20349673/P18161_217_S90_L004/oral_catalog/mapping/P18161_217_S90_L004/mapping_vs_Homo_sapiens_GRCh38_P18161_217_S90_L004_2/P18161_217_S90_L004_2_1.sam
33529966 reads; of these:
  33529966 (100.00%) were unpaired; of these:
    5168408 (15.41%) aligned 0 times
    28361558 (84.59%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
84.59% overall alignment rate

######### TaskExcludedMapping(1, 2) ; reference name: A_thaliana_TAIR10
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349673/reference/A_thaliana_TAIR10/fasta/A_thaliana_TAIR10_dnaspace_index -U /scratch/20349673/P18161_217_S90_L004/oral_catalog/sample/P18161_217_S90_L004/0daf3062f0eb74ba5ec7070b4476b260/P18161_217_S90_L004_2.fastq.idx -S /scratch/20349673/P18161_217_S90_L004/oral_catalog/mapping/P18161_217_S90_L004/mapping_vs_A_thaliana_TAIR10_P18161_217_S90_L004_2/P18161_217_S90_L004_2_1.sam
33529966 reads; of these:
  33529966 (100.00%) were unpaired; of these:
    33524328 (99.98%) aligned 0 times
    5638 (0.02%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
0.02% overall alignment rate

######### TaskExcludedMapping(1, 3) ; reference name: Bos_taurus_UMD3
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349673/reference/Bos_taurus_UMD3/fasta/Bos_taurus_UMD3_dnaspace_index -U /scratch/20349673/P18161_217_S90_L004/oral_catalog/sample/P18161_217_S90_L004/0daf3062f0eb74ba5ec7070b4476b260/P18161_217_S90_L004_2.fastq.idx -S /scratch/20349673/P18161_217_S90_L004/oral_catalog/mapping/P18161_217_S90_L004/mapping_vs_Bos_taurus_UMD3_P18161_217_S90_L004_2/P18161_217_S90_L004_2_1.sam
33529966 reads; of these:
  33529966 (100.00%) were unpaired; of these:
    33041763 (98.54%) aligned 0 times
    488203 (1.46%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
1.46% overall alignment rate
removing re-indexed file:
/scratch/20349673/P18161_217_S90_L004/oral_catalog/sample/P18161_217_S90_L004/0daf3062f0eb74ba5ec7070b4476b260/P18161_217_S90_L004_2.fastq.idx

Launch counting

Executing counting command:
meteor-counter -w inifiles/P18161_217_S90_L004.ini -i /scratch/20349673/P18161_217_S90_L004/oral_catalog/sample/P18161_217_S90_L004 -p /scratch/20349673/P18161_217_S90_L004/oral_catalog -o mapping
######### workspace preparation
######### Meteor task description
Sample name = P18161_217_S90_L004
Library name = P18161_217_S90_L004_1
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_217_S90_L004.ini
######### Meteor task description
Sample name = P18161_217_S90_L004
Library name = P18161_217_S90_L004_2
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_217_S90_L004.ini
######### Task main counting

Job finished !
Done !
Job finished without errors ...
...Mon Jun  7 04:30:29 CEST 2021: Map_reads - done

...Mon Jun  7 04:30:29 CEST 2021: Quantify - begin
SampleCount: 1
RunSampleCount: 2

######### profiling job started

1000000 processed records.
2000000 processed records.
3000000 processed records.
4000000 processed records.
5000000 processed records.
6000000 processed records.
7000000 processed records.
8000000 processed records.
8403558 processed records.

Merged profiled data are saved here: /scratch/20349673/P18161_217_S90_L004/oral_catalog/profiles/P18161_217_S90_L004.tsv

Counting report is saved here: /scratch/20349673/P18161_217_S90_L004/oral_catalog/profiles/P18161_217_S90_L004_counting_report.csv

Extended counting report is saved here: /scratch/20349673/P18161_217_S90_L004/oral_catalog/profiles/P18161_217_S90_L004_extended_counting_report.csv

######### Job finished
...Mon Jun  7 04:30:56 CEST 2021: Quantify - done

...Mon Jun  7 04:30:56 CEST 2021: Recover - begin
sending incremental file list
./
oral_catalog/
oral_catalog/mapping/
oral_catalog/profiles/
oral_catalog/profiles/P18161_217_S90_L004.tsv
         32,768   0%    0.00kB/s    0:00:00       84,798,026 100%  215.00MB/s    0:00:00 (xfr#1, to-chk=8/15)
oral_catalog/profiles/P18161_217_S90_L004_counting_report.csv
            501 100%    1.30kB/s    0:00:00              501 100%    1.30kB/s    0:00:00 (xfr#2, to-chk=7/15)
oral_catalog/profiles/P18161_217_S90_L004_extended_counting_report.csv
            754 100%    1.95kB/s    0:00:00              754 100%    1.95kB/s    0:00:00 (xfr#3, to-chk=6/15)
oral_catalog/profiles/P18161_217_S90_L004_gene_profile.ini
          3,095 100%    8.02kB/s    0:00:00            3,095 100%    8.02kB/s    0:00:00 (xfr#4, to-chk=5/15)
oral_catalog/sample/
oral_catalog/sample/P18161_217_S90_L004/
oral_catalog/sample/P18161_217_S90_L004/P18161_217_S90_L004_1.fastq
         32,768   0%   80.40kB/s   41:31:50      102,268,928   0%   97.53MB/s    0:01:59      270,303,232   2%  128.44MB/s    0:01:29      439,484,416   3%  139.43MB/s    0:01:21      626,556,928   5%  149.20MB/s    0:01:14      800,849,920   6%  166.39MB/s    0:01:05      894,205,952   7%  148.82MB/s    0:01:13    1,056,178,176   8%  147.10MB/s    0:01:12    1,230,110,720  10%  143.97MB/s    0:01:13    1,407,746,048  11%  144.73MB/s    0:01:11    1,590,722,560  13%  162.53MB/s    0:01:02    1,758,429,184  14%  163.87MB/s    0:01:01    1,936,195,584  16%  164.76MB/s    0:00:59    2,087,223,296  17%  158.55MB/s    0:01:01    2,260,500,480  18%  159.81MB/s    0:00:59    2,435,874,816  20%  161.64MB/s    0:00:57    2,595,586,048  21%  157.33MB/s    0:00:58    2,767,224,832  23%  162.25MB/s    0:00:55    2,939,453,440  24%  161.96MB/s    0:00:54    3,123,544,064  25%  164.04MB/s    0:00:52    3,306,192,896  27%  169.46MB/s    0:00:50    3,476,553,728  28%  169.16MB/s    0:00:49    3,646,521,344  30%  168.66MB/s    0:00:48    3,815,636,992  31%  165.09MB/s    0:00:48    3,994,484,736  33%  164.22MB/s    0:00:47    4,163,436,544  34%  163.89MB/s    0:00:46    4,334,092,288  36%  164.05MB/s    0:00:45    4,513,071,104  37%  166.41MB/s    0:00:44    4,680,548,352  38%  163.69MB/s    0:00:43    4,856,315,904  40%  165.32MB/s    0:00:42    5,033,295,872  41%  166.83MB/s    0:00:40    5,199,003,648  43%  163.66MB/s    0:00:40    5,367,136,256  44%  163.82MB/s    0:00:39    5,534,154,752  46%  161.73MB/s    0:00:39    5,708,152,832  47%  161.02MB/s    0:00:38    5,880,741,888  48%  162.66MB/s    0:00:36    6,040,354,816  50%  160.63MB/s    0:00:36    6,214,615,040  51%  162.36MB/s    0:00:34    6,380,421,120  53%  160.40MB/s    0:00:34    6,561,562,624  54%  162.44MB/s    0:00:32    6,728,876,032  55%  164.28MB/s    0:00:31    6,894,944,256  57%  162.32MB/s    0:00:30    7,069,368,320  58%  164.38MB/s    0:00:29    7,241,105,408  60%  162.14MB/s    0:00:28    7,411,204,096  61%  162.80MB/s    0:00:27    7,582,646,272  63%  164.08MB/s    0:00:26    7,761,592,320  64%  165.16MB/s    0:00:25    7,923,859,456  65%  162.90MB/s    0:00:24    8,094,875,648  67%  163.12MB/s    0:00:23    8,271,331,328  68%  164.32MB/s    0:00:22    8,458,371,072  70%  166.25MB/s    0:00:20    8,632,958,976  71%  169.15MB/s    0:00:19    8,807,546,880  73%  170.00MB/s    0:00:18    8,984,756,224  74%  170.09MB/s    0:00:17    9,175,597,056  76%  171.04MB/s    0:00:16    9,352,445,952  77%  171.58MB/s    0:00:15    9,534,013,440  79%  173.29MB/s    0:00:14    9,709,060,096  80%  172.77MB/s    0:00:13    9,883,385,856  82%  168.88MB/s    0:00:12   10,060,333,056  83%  168.86MB/s    0:00:11   10,241,212,416  85%  168.69MB/s    0:00:10   10,427,334,656  86%  171.34MB/s    0:00:09   10,607,362,048  88%  172.74MB/s    0:00:07   10,764,779,520  89%  168.08MB/s    0:00:07   10,944,512,000  91%  167.81MB/s    0:00:06   11,127,685,120  92%  167.10MB/s    0:00:05   11,310,497,792  94%  167.77MB/s    0:00:04   11,488,493,568  95%  172.68MB/s    0:00:03   11,663,802,368  97%  171.62MB/s    0:00:02   11,841,732,608  98%  170.37MB/s    0:00:01   12,000,788,480  99%  164.70MB/s    0:00:00   12,020,949,776 100%  163.38MB/s    0:01:10 (xfr#5, to-chk=3/15)
oral_catalog/sample/P18161_217_S90_L004/P18161_217_S90_L004_1_census_stage_0.ini
            273 100%    2.17kB/s    0:00:00              273 100%    2.17kB/s    0:00:00 (xfr#6, to-chk=2/15)
oral_catalog/sample/P18161_217_S90_L004/P18161_217_S90_L004_2.fastq
         32,768   0%  222.22kB/s   14:56:21      140,804,096   1%  134.28MB/s    0:01:25      321,421,312   2%  153.34MB/s    0:01:14      503,349,248   4%  160.01MB/s    0:01:09      685,244,416   5%  163.42MB/s    0:01:07      849,641,472   7%  167.87MB/s    0:01:04    1,029,996,544   8%  167.80MB/s    0:01:03    1,199,013,888  10%  164.83MB/s    0:01:03    1,360,953,344  11%  160.10MB/s    0:01:04    1,525,612,544  12%  161.29MB/s    0:01:03    1,703,051,264  14%  160.59MB/s    0:01:02    1,884,848,128  15%  163.64MB/s    0:01:00    2,055,503,872  17%  165.72MB/s    0:00:58    2,223,734,784  18%  166.57MB/s    0:00:57    2,401,501,184  20%  166.65MB/s    0:00:55    2,588,278,784  21%  167.84MB/s    0:00:54    2,762,342,400  23%  168.65MB/s    0:00:53    2,938,863,616  24%  170.63MB/s    0:00:51    3,112,206,336  26%  169.45MB/s    0:00:50    3,280,797,696  27%  165.11MB/s    0:00:51    3,451,224,064  28%  164.24MB/s    0:00:50    3,626,008,576  30%  163.83MB/s    0:00:49    3,791,683,584  31%  161.92MB/s    0:00:49    3,956,375,552  33%  160.99MB/s    0:00:48    4,124,934,144  34%  160.58MB/s    0:00:47    4,303,192,064  36%  161.41MB/s    0:00:46    4,487,217,152  37%  165.95MB/s    0:00:43    4,655,448,064  38%  165.93MB/s    0:00:42    4,829,216,768  40%  167.16MB/s    0:00:41    5,003,640,832  41%  166.13MB/s    0:00:40    5,179,047,936  43%  164.08MB/s    0:00:40    5,349,867,520  44%  165.56MB/s    0:00:38    5,521,899,520  46%  165.15MB/s    0:00:38    5,701,468,160  47%  166.50MB/s    0:00:36    5,883,854,848  49%  168.12MB/s    0:00:35    6,052,478,976  50%  167.60MB/s    0:00:34    6,231,457,792  52%  169.26MB/s    0:00:33    6,405,947,392  53%  168.04MB/s    0:00:32    6,585,024,512  55%  167.30MB/s    0:00:31    6,754,500,608  56%  167.50MB/s    0:00:30    6,933,381,120  58%  167.48MB/s    0:00:29    7,118,520,320  59%  170.02MB/s    0:00:27    7,296,614,400  61%  169.78MB/s    0:00:26    7,469,039,616  62%  170.49MB/s    0:00:25    7,636,418,560  63%  167.74MB/s    0:00:25    7,818,215,424  65%  166.95MB/s    0:00:24    7,988,871,168  66%  165.17MB/s    0:00:23    8,170,536,960  68%  167.38MB/s    0:00:22    8,338,112,512  69%  167.42MB/s    0:00:21    8,520,040,448  71%  167.45MB/s    0:00:20    8,692,170,752  72%  167.81MB/s    0:00:18    8,869,347,328  74%  166.73MB/s    0:00:18    9,055,961,088  75%  171.28MB/s    0:00:16    9,229,074,432  77%  169.17MB/s    0:00:15    9,411,756,032  78%  171.69MB/s    0:00:14    9,589,784,576  80%  171.89MB/s    0:00:13    9,770,926,080  81%  170.59MB/s    0:00:12    9,939,025,920  83%  169.39MB/s    0:00:11   10,120,364,032  84%  169.07MB/s    0:00:10   10,290,298,880  86%  167.14MB/s    0:00:09   10,468,753,408  87%  166.33MB/s    0:00:08   10,637,443,072  89%  166.47MB/s    0:00:07   10,817,339,392  90%  166.17MB/s    0:00:06   10,996,711,424  92%  168.38MB/s    0:00:05   11,178,115,072  93%  169.25MB/s    0:00:04   11,354,996,736  95%  171.21MB/s    0:00:03   11,531,812,864  96%  170.47MB/s    0:00:02   11,699,519,488  97%  167.69MB/s    0:00:01   11,867,029,504  99%  164.37MB/s    0:00:00   11,951,562,246 100%  166.29MB/s    0:01:08 (xfr#7, to-chk=1/15)
oral_catalog/sample/P18161_217_S90_L004/P18161_217_S90_L004_2_census_stage_0.ini
            273 100%    0.50kB/s    0:00:00              273 100%    0.50kB/s    0:00:00 (xfr#8, to-chk=0/15)
working/

sent 24,063,189,230 bytes  received 267 bytes  170,057,876.30 bytes/sec
total size is 24,057,314,944  speedup is 1.00
...Mon Jun  7 04:33:17 CEST 2021: Recover - done

