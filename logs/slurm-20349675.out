...Sat Jun  5 23:17:50 CEST 2021: - begin running script
#!/bin/bash -l
#SBATCH --account=snic2021-5-248
#SBATCH --partition=core
#SBATCH --ntasks=10
#SBATCH --time=2-00:00:00
#SBATCH --job-name=anotherbatch
#SBATCH --mail-user=zn.tportlock@gmail.com
#SBATCH --mail-type=ALL
##SBATCH --output=/proj/uppstore2019028/projects/metagenome/theo/newscripts/meteor/logs/%j 

set -a

function Run {
	echo "...$(date): $1 - begin"
	$@ \
	&& (echo "...$(date): $1 - done"; echo "") \
	|| (echo "...$(date): $1 - failed"; echo ""; exit 1)
}
function Parse_variables {
	v_project_dir=$TMPDIR/$sampleId
	v_workdir="${v_project_dir}/working/$sampleId"
	v_fastqgz1=$(readlink -f ${fastqgzs[0]})
	v_fastqgz2=$(readlink -f ${fastqgzs[1]})
	v_fastqgz1_unzip="${v_workdir}/$(basename $v_fastqgz1 .gz).unzipped"
	v_fastqgz2_unzip="${v_workdir}/$(basename $v_fastqgz2 .gz).unzipped"
	v_trimmedS="${v_workdir}/${sampleId}.trimmed.s.fastq"
	v_final1="${v_workdir}/${sampleId}_1.fastq"
	v_final2="${v_workdir}/${sampleId}_2.fastq"
	v_sampledir=${v_project_dir}/${catalog_type}/sample/${sampleId}
	v_downstream_dir="$v_project_dir/Downstream"
	vars=$(compgen -A variable | grep "^v_.*")
	for var in ${vars}; do echo "${var}=${!var}"; done
	for var in ${vars}; do if [[ -z "${!var}" ]]; then echo "missing argument ${var}" ; return 1 ; fi ; done
}
function Init {
	mkdir -p ${v_project_dir}/${catalog_type}/{sample,mapping,profiles}
	mkdir -p $TMPDIR/reference
	mkdir -p ${v_workdir}
}
function Send {
	cp $v_fastqgz1 ${v_workdir}
	cp $v_fastqgz2 ${v_workdir}
	cp -r ${reference_dir}/* $TMPDIR/reference
	cp -r ${trimFasta} $TMPDIR
}
function Decompress {
	zcat ${v_workdir}/$(basename $v_fastqgz1) > $v_fastqgz1_unzip & pid1=$!
	zcat ${v_workdir}/$(basename $v_fastqgz2) > $v_fastqgz2_unzip & pid2=$!
	trap "kill -2 $pid1 $pid2" SIGINT
	wait
}
function Trim {
	[[ -f $v_fastqgz1_unzip && -f $v_fastqgz2_unzip ]] \
	|| (echo "zip file not found" ; return 1 )
	java -jar ${ALIEN_TRIMMER}/AlienTrimmer.jar \
		-k 10 -l 45 -m 5 -p 40 -q 20 \
		-if ${v_fastqgz1_unzip} -ir ${v_fastqgz2_unzip} -c $TMPDIR/$(basename $trimFasta) \
		-of ${v_final1} -or ${v_final2} -os ${v_trimmedS} \
	|| return 1
}
function Import {
	[[ -f $v_final1 && -f $v_final2 ]] \
	|| (echo "trimmed files not found" ; return 1 )
	mv ${v_final1} ${v_final2} ${v_project_dir}/${catalog_type}/sample &&
	rm -r ${v_workdir}
	ruby ${meteorImportScript} \
		-i ${v_project_dir}/${catalog_type}/sample \
		-p ${catalog_type} \
		-t ${seq_platform} \
		-m "${sampleId}*" \
	|| return 1
}
function Map_reads {
	ruby ${meteor}/meteor.rb \
		-w ${ini_file} \
		-i ${v_sampledir} \
		-p ${v_project_dir}/${catalog_type} \
		-o mapping \
	|| return 1
}
function Quantify {
	${meteor}/meteor-profiler \
		-p ${v_project_dir}/${catalog_type} \
		-f ${v_project_dir}/${catalog_type}/profiles \
		-t smart_shared_reads \
		-w ${ini_file} \
		-o ${sampleId} ${v_project_dir}/${catalog_type}/mapping/${sampleId}/${sampleId}_${v_prefix}_gene_profile/census.dat \
	&& rm -r ${v_project_dir}/${catalog_type}/mapping/${sampleId} \
	|| return 1
}
function Recover {
	rsync -aurvP --remove-source-files $v_project_dir/ $project_dir_rel
}
function PrepareReports {
	inFile=$v_downstream_dir/$1.csv
	outFile=$v_downstream_dir/$1.final.csv
	cat $v_project_dir/$catalog_type/profiles/*$1.csv > $inFile
	head -1 $inFile > ${outFile}.header
	cat $inFile | grep -v sample > ${outFile}.body
	cat ${outFile}.header ${outFile}.body > ${outFile}
	rm ${inFile} ${outFile}.header ${outFile}.body
}
function PrepareGCT {
	inFile=$v_downstream_dir/merged.tsv
	outFile=$v_downstream_dir/merged.final.tsv
	paste $v_project_dir/$catalog_type/profiles/*.tsv > $inFile
	width=$(head -1 $inFile | awk '{print NF}')
	echo $width
	cat $inFile | cut -f1 | sed 's/\#id_fragment/gene_id/g' > ${outFile}.gene
	cat $inFile | awk -v width="$width" 'BEGIN{OFS="\t"}{s="";for(i=2;i<=width;i=i+2){if (i!=width)s=s $i "\t"; if (i==width) s=s $i}; print s}' > ${outFile}.expr
	paste ${outFile}.gene ${outFile}.expr > ${outFile}
	rm ${inFile} ${outFile}.gene ${outFile}.expr
}
function SaveGCT {
	#cd $v_downstream_dir
	Rscript $Rdir/save.gct.r  \
		$v_downstream_dir/merged.final.tsv \
		merged.final \
		$v_downstream_dir \
	|| return 1
}
function Normalize {
	#cd $v_downstream_dir
	Rscript $Rdir/get.norm.downsize.r \
		$v_downstream_dir/merged.final.RData \
		merged.final \
		$v_downstream_dir \
		$v_downstream_dir \
	|| return 1
}
function GetMGS {
	Rscript $Rdir/get.oral.mgs.from.norm.r \
		$v_downstream_dir/merged.final.norm.10M.RData \
		merged.final \
		$v_downstream_dir \
		$v_downstream_dir \
	|| return 1
}

Main() {
	sampleId=$(basename $1 .fastq.gz)
	fastqgzs+=("$2")
	fastqgzs+=("$3")

	Run Parse_variables &&
	Run Init &&
	Run Send &&
	Run Decompress &&
	Run Trim &&
	Run Import &&
	Run Map_reads &&
	Run Quantify &&
	Run Recover
}
Downstream() {
	v_project_dir=$(readlink -f $project_dir_rel)
	v_downstream_dir="$v_project_dir/Downstream"
	mkdir -p $v_downstream_dir

	Run PrepareReports counting_report &&
	Run PrepareReports extended_counting_report &&
	Run PrepareGCT &&
	Run SaveGCT &&
	Run Normalize &&
	Run GetMGS 
}

echo "...$(date): - begin running script"
cat $0
echo ""

# Load modules
echo "...$(date): - load modules"
module load bioinfo-tools
module load ruby/2.6.2
module load AlienTrimmer/0.4.0
module load bowtie2/2.3.4.1
echo "...$(date): - done; echo ''"

# Load ini file
echo "...$(date): - load ini file"
sed -i "s|meteor.reference.dir=.*|meteor.reference.dir=$TMPDIR/reference|g" $1
ini_file=$1
source $ini_file > /dev/null 2>&1
v_prefix=$( grep "meteor.counting.prefix.name" $ini_file | sed "s/^.*=//g" )
cat $ini_file
echo "...$(date): - done; echo ''"

# Run meteor
Main $sample $seq_data_dir/${sample}${forward_identifier} $seq_data_dir/${sample}${reverse_identifier}

# Run the downstream analysis
#Downstream

...Sat Jun  5 23:17:50 CEST 2021: - load modules
Bowtie2 looks for the specified index first in the current directory, then in the directory specified in the BOWTIE2_INDEXES environment variable.
The pregenerated indexes for the reference genonomes are placed under /sw/data/reference/*/*/program_files/bowtie2 for each reference genome
...Sat Jun  5 23:17:57 CEST 2021: - done; echo ''
...Sat Jun  5 23:17:57 CEST 2021: - load ini file
[Pipeline]
sample=P18161_219/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_219_S92_L004
forward_identifier="_R1_001.fastq.gz"
reverse_identifier="_R2_001.fastq.gz"
seq_data_dir="/proj/snic2020-6-153/delivery04021/P18161"
project_dir_rel="/proj/uppstore2019028/projects/metagenome/theo/newscripts/tmp"
catalog_type="oral_catalog"
seq_platform="illumina"
trimFasta="/proj/uppstore2019028/projects/metagenome/alienTrimmerPF8contaminants.fasta"
meteorImportScript="/proj/uppstore2019028/meteor.2019.11.04/MeteorImportFastq.rb"
meteor="/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04"
Rdir="/proj/uppstore2019028/projects/metagenome/meteor_downstream_rscripts"
reference_dir="/proj/uppstore2019028/projects/metagenome/meteor_ref"
[worksession]
meteor.reference.dir=/scratch/20349675/reference
meteor.db.type=binary
meteor.nb.attempts=3
meteor.read.cleaning.program=none
meteor.read.cleaning.cmd=
meteor.mapping.program=bowtie2
meteor.mapping.file.format=sam
meteor.is.cpu.percentage=0
meteor.cpu.count=10
meteor.checksum=md5
meteor.excluded.reference.count=3
[main_reference]
meteor.reference.name=oral_catalog
meteor.matches=10000
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapper.cmd=
meteor.mapping.prefix.name=mapping_vs_oral_catalog
meteor.counting.prefix.name=vs_hs_10_4_oral_catalog
[excluded_reference_1]
meteor.reference.name=Homo_sapiens_GRCh38
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_Homo_sapiens_GRCh38
[excluded_reference_2]
meteor.reference.name=A_thaliana_TAIR10
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_A_thaliana_TAIR10
[excluded_reference_3]
meteor.reference.name=Bos_taurus_UMD3
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_Bos_taurus_UMD3
...Sat Jun  5 23:17:57 CEST 2021: - done; echo ''
...Sat Jun  5 23:17:57 CEST 2021: Parse_variables - begin
v_downstream_dir=/scratch/20349675/P18161_219_S92_L004/Downstream
v_fastqgz1=/crex/proj/snic2020-6-153/nobackup/delivery04021/P18161/P18161_219/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_219_S92_L004_R1_001.fastq.gz
v_fastqgz1_unzip=/scratch/20349675/P18161_219_S92_L004/working/P18161_219_S92_L004/P18161_219_S92_L004_R1_001.fastq.unzipped
v_fastqgz2=/crex/proj/snic2020-6-153/nobackup/delivery04021/P18161/P18161_219/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_219_S92_L004_R2_001.fastq.gz
v_fastqgz2_unzip=/scratch/20349675/P18161_219_S92_L004/working/P18161_219_S92_L004/P18161_219_S92_L004_R2_001.fastq.unzipped
v_final1=/scratch/20349675/P18161_219_S92_L004/working/P18161_219_S92_L004/P18161_219_S92_L004_1.fastq
v_final2=/scratch/20349675/P18161_219_S92_L004/working/P18161_219_S92_L004/P18161_219_S92_L004_2.fastq
v_prefix=vs_hs_10_4_oral_catalog
v_project_dir=/scratch/20349675/P18161_219_S92_L004
v_sampledir=/scratch/20349675/P18161_219_S92_L004/oral_catalog/sample/P18161_219_S92_L004
v_trimmedS=/scratch/20349675/P18161_219_S92_L004/working/P18161_219_S92_L004/P18161_219_S92_L004.trimmed.s.fastq
v_workdir=/scratch/20349675/P18161_219_S92_L004/working/P18161_219_S92_L004
...Sat Jun  5 23:17:57 CEST 2021: Parse_variables - done

...Sat Jun  5 23:17:57 CEST 2021: Init - begin
...Sat Jun  5 23:17:57 CEST 2021: Init - done

...Sat Jun  5 23:17:57 CEST 2021: Send - begin
...Sun Jun  6 00:11:40 CEST 2021: Send - done

...Sun Jun  6 00:11:52 CEST 2021: Decompress - begin
...Sun Jun  6 00:17:12 CEST 2021: Decompress - done

...Sun Jun  6 00:17:23 CEST 2021: Trim - begin
AlienTrimmer main options: -k 10 -l 45 -m 5 -q 20 -p 40 (Phred+33)  /  439 fwd alien sequence(s)  /  7856 fwd k-mers (k=10)  /  439 rev alien sequence(s)  /  7856 rev k-mers (k=10)
[02:13]   1,000,000 read pairs processed:     659,680 trimmed (fwd:     309,980  rev:     349,700)      11,521 removed (fwd:       3,787  rev:       7,734)
[04:20]   2,000,000 read pairs processed:   1,320,951 trimmed (fwd:     611,338  rev:     709,613)      23,690 removed (fwd:       7,032  rev:      16,658)
[06:20]   3,000,000 read pairs processed:   1,970,557 trimmed (fwd:     914,646  rev:   1,055,911)      34,321 removed (fwd:      10,427  rev:      23,894)
[08:14]   4,000,000 read pairs processed:   2,628,897 trimmed (fwd:   1,215,130  rev:   1,413,767)      46,284 removed (fwd:      13,539  rev:      32,745)
[10:14]   5,000,000 read pairs processed:   3,275,020 trimmed (fwd:   1,515,691  rev:   1,759,329)      56,978 removed (fwd:      16,784  rev:      40,194)
[12:09]   6,000,000 read pairs processed:   3,929,380 trimmed (fwd:   1,814,040  rev:   2,115,340)      68,731 removed (fwd:      19,915  rev:      48,816)
[14:02]   7,000,000 read pairs processed:   4,567,655 trimmed (fwd:   2,109,280  rev:   2,458,375)      79,421 removed (fwd:      23,183  rev:      56,238)
[15:55]   8,000,000 read pairs processed:   5,218,289 trimmed (fwd:   2,407,408  rev:   2,810,881)      90,622 removed (fwd:      26,260  rev:      64,362)
[17:50]   9,000,000 read pairs processed:   5,861,179 trimmed (fwd:   2,702,420  rev:   3,158,759)     100,971 removed (fwd:      29,387  rev:      71,584)
[19:44]  10,000,000 read pairs processed:   6,511,992 trimmed (fwd:   3,002,491  rev:   3,509,501)     111,694 removed (fwd:      32,574  rev:      79,120)
[21:36]  11,000,000 read pairs processed:   7,147,625 trimmed (fwd:   3,300,954  rev:   3,846,671)     122,612 removed (fwd:      36,246  rev:      86,366)
[23:33]  12,000,000 read pairs processed:   7,849,108 trimmed (fwd:   3,625,321  rev:   4,223,787)     134,176 removed (fwd:      39,564  rev:      94,612)
[25:31]  13,000,000 read pairs processed:   8,589,014 trimmed (fwd:   3,969,220  rev:   4,619,794)     146,645 removed (fwd:      43,271  rev:     103,374)
[27:30]  14,000,000 read pairs processed:   9,323,565 trimmed (fwd:   4,307,566  rev:   5,015,999)     158,207 removed (fwd:      46,758  rev:     111,449)
[29:24]  15,000,000 read pairs processed:  10,032,900 trimmed (fwd:   4,631,376  rev:   5,401,524)     169,379 removed (fwd:      50,333  rev:     119,046)
[31:17]  16,000,000 read pairs processed:  10,744,830 trimmed (fwd:   4,961,810  rev:   5,783,020)     180,574 removed (fwd:      54,013  rev:     126,561)
[33:11]  17,000,000 read pairs processed:  11,435,434 trimmed (fwd:   5,279,392  rev:   6,156,042)     191,376 removed (fwd:      57,481  rev:     133,895)
[35:05]  18,000,000 read pairs processed:  12,128,515 trimmed (fwd:   5,599,406  rev:   6,529,109)     201,943 removed (fwd:      61,027  rev:     140,916)
[36:58]  19,000,000 read pairs processed:  12,814,884 trimmed (fwd:   5,913,478  rev:   6,901,406)     212,440 removed (fwd:      64,324  rev:     148,116)
[38:51]  20,000,000 read pairs processed:  13,510,098 trimmed (fwd:   6,237,106  rev:   7,272,992)     223,040 removed (fwd:      67,883  rev:     155,157)
[41:13]  21,000,000 read pairs processed:  14,212,840 trimmed (fwd:   6,561,719  rev:   7,651,121)     234,020 removed (fwd:      71,465  rev:     162,555)
[43:31]  22,000,000 read pairs processed:  14,924,846 trimmed (fwd:   6,892,845  rev:   8,032,001)     245,336 removed (fwd:      75,552  rev:     169,784)
[44:36]  22,570,654 read pairs processed:  15,314,694 trimmed (fwd:   7,071,244  rev:   8,243,450)     251,195 removed (fwd:      77,385  rev:     173,810)
...Sun Jun  6 01:02:57 CEST 2021: Trim - done

...Sun Jun  6 01:02:57 CEST 2021: Import - begin
ruby: warning: shebang line ending with \r may cause problems
Import /scratch/20349675/P18161_219_S92_L004/oral_catalog/sample/P18161_219_S92_L004_1.fastq
Import /scratch/20349675/P18161_219_S92_L004/oral_catalog/sample/P18161_219_S92_L004_2.fastq
Importation done!
...Sun Jun  6 01:03:01 CEST 2021: Import - done

...Sun Jun  6 01:03:01 CEST 2021: Map_reads - begin
/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04/meteor.rb:146: warning: constant ::Fixnum is deprecated
/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04/meteor.rb:161: warning: Insecure world writable dir /proj/uppstore2019028/Helen/meteor-linux.2019-11-04 in PATH, mode 042777

Launch mapping


######### Meteor Mapping task description
Sample name = P18161_219_S92_L004
Library name = P18161_219_S92_L004_1
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_219_S92_L004.ini

######### Task main mapping 0
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 10000 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349675/reference/oral_catalog/fasta/oral_catalog_dnaspace_index -U /scratch/20349675/P18161_219_S92_L004/oral_catalog/sample/P18161_219_S92_L004/59a783840b78ae1046e4c4f6d9607d7a/P18161_219_S92_L004_1.fastq.idx -S /scratch/20349675/P18161_219_S92_L004/oral_catalog/mapping/P18161_219_S92_L004/mapping_vs_oral_catalog_P18161_219_S92_L004_1/P18161_219_S92_L004_1_1.sam
22334437 reads; of these:
  22334437 (100.00%) were unpaired; of these:
    12781646 (57.23%) aligned 0 times
    2124373 (9.51%) aligned exactly 1 time
    7428418 (33.26%) aligned >1 times
42.77% overall alignment rate

######### TaskExcludedMapping(0, 1) ; reference name: Homo_sapiens_GRCh38
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349675/reference/Homo_sapiens_GRCh38/fasta/Homo_sapiens_GRCh38_dnaspace_index -U /scratch/20349675/P18161_219_S92_L004/oral_catalog/sample/P18161_219_S92_L004/59a783840b78ae1046e4c4f6d9607d7a/P18161_219_S92_L004_1.fastq.idx -S /scratch/20349675/P18161_219_S92_L004/oral_catalog/mapping/P18161_219_S92_L004/mapping_vs_Homo_sapiens_GRCh38_P18161_219_S92_L004_1/P18161_219_S92_L004_1_1.sam
22334437 reads; of these:
  22334437 (100.00%) were unpaired; of these:
    10499856 (47.01%) aligned 0 times
    11834581 (52.99%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
52.99% overall alignment rate

######### TaskExcludedMapping(0, 2) ; reference name: A_thaliana_TAIR10
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349675/reference/A_thaliana_TAIR10/fasta/A_thaliana_TAIR10_dnaspace_index -U /scratch/20349675/P18161_219_S92_L004/oral_catalog/sample/P18161_219_S92_L004/59a783840b78ae1046e4c4f6d9607d7a/P18161_219_S92_L004_1.fastq.idx -S /scratch/20349675/P18161_219_S92_L004/oral_catalog/mapping/P18161_219_S92_L004/mapping_vs_A_thaliana_TAIR10_P18161_219_S92_L004_1/P18161_219_S92_L004_1_1.sam
22334437 reads; of these:
  22334437 (100.00%) were unpaired; of these:
    22330020 (99.98%) aligned 0 times
    4417 (0.02%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
0.02% overall alignment rate

######### TaskExcludedMapping(0, 3) ; reference name: Bos_taurus_UMD3
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349675/reference/Bos_taurus_UMD3/fasta/Bos_taurus_UMD3_dnaspace_index -U /scratch/20349675/P18161_219_S92_L004/oral_catalog/sample/P18161_219_S92_L004/59a783840b78ae1046e4c4f6d9607d7a/P18161_219_S92_L004_1.fastq.idx -S /scratch/20349675/P18161_219_S92_L004/oral_catalog/mapping/P18161_219_S92_L004/mapping_vs_Bos_taurus_UMD3_P18161_219_S92_L004_1/P18161_219_S92_L004_1_1.sam
22334437 reads; of these:
  22334437 (100.00%) were unpaired; of these:
    22130291 (99.09%) aligned 0 times
    204146 (0.91%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
0.91% overall alignment rate
removing re-indexed file:
/scratch/20349675/P18161_219_S92_L004/oral_catalog/sample/P18161_219_S92_L004/59a783840b78ae1046e4c4f6d9607d7a/P18161_219_S92_L004_1.fastq.idx


######### Meteor Mapping task description
Sample name = P18161_219_S92_L004
Library name = P18161_219_S92_L004_2
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_219_S92_L004.ini

######### Task main mapping 1
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 10000 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349675/reference/oral_catalog/fasta/oral_catalog_dnaspace_index -U /scratch/20349675/P18161_219_S92_L004/oral_catalog/sample/P18161_219_S92_L004/59a783840b78ae1046e4c4f6d9607d7a/P18161_219_S92_L004_2.fastq.idx -S /scratch/20349675/P18161_219_S92_L004/oral_catalog/mapping/P18161_219_S92_L004/mapping_vs_oral_catalog_P18161_219_S92_L004_2/P18161_219_S92_L004_2_1.sam
22334437 reads; of these:
  22334437 (100.00%) were unpaired; of these:
    12822468 (57.41%) aligned 0 times
    2150612 (9.63%) aligned exactly 1 time
    7361357 (32.96%) aligned >1 times
42.59% overall alignment rate

######### TaskExcludedMapping(1, 1) ; reference name: Homo_sapiens_GRCh38
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349675/reference/Homo_sapiens_GRCh38/fasta/Homo_sapiens_GRCh38_dnaspace_index -U /scratch/20349675/P18161_219_S92_L004/oral_catalog/sample/P18161_219_S92_L004/59a783840b78ae1046e4c4f6d9607d7a/P18161_219_S92_L004_2.fastq.idx -S /scratch/20349675/P18161_219_S92_L004/oral_catalog/mapping/P18161_219_S92_L004/mapping_vs_Homo_sapiens_GRCh38_P18161_219_S92_L004_2/P18161_219_S92_L004_2_1.sam
22334437 reads; of these:
  22334437 (100.00%) were unpaired; of these:
    10484688 (46.94%) aligned 0 times
    11849749 (53.06%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
53.06% overall alignment rate

######### TaskExcludedMapping(1, 2) ; reference name: A_thaliana_TAIR10
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349675/reference/A_thaliana_TAIR10/fasta/A_thaliana_TAIR10_dnaspace_index -U /scratch/20349675/P18161_219_S92_L004/oral_catalog/sample/P18161_219_S92_L004/59a783840b78ae1046e4c4f6d9607d7a/P18161_219_S92_L004_2.fastq.idx -S /scratch/20349675/P18161_219_S92_L004/oral_catalog/mapping/P18161_219_S92_L004/mapping_vs_A_thaliana_TAIR10_P18161_219_S92_L004_2/P18161_219_S92_L004_2_1.sam
22334437 reads; of these:
  22334437 (100.00%) were unpaired; of these:
    22329951 (99.98%) aligned 0 times
    4486 (0.02%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
0.02% overall alignment rate

######### TaskExcludedMapping(1, 3) ; reference name: Bos_taurus_UMD3
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349675/reference/Bos_taurus_UMD3/fasta/Bos_taurus_UMD3_dnaspace_index -U /scratch/20349675/P18161_219_S92_L004/oral_catalog/sample/P18161_219_S92_L004/59a783840b78ae1046e4c4f6d9607d7a/P18161_219_S92_L004_2.fastq.idx -S /scratch/20349675/P18161_219_S92_L004/oral_catalog/mapping/P18161_219_S92_L004/mapping_vs_Bos_taurus_UMD3_P18161_219_S92_L004_2/P18161_219_S92_L004_2_1.sam
22334437 reads; of these:
  22334437 (100.00%) were unpaired; of these:
    22130706 (99.09%) aligned 0 times
    203731 (0.91%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
0.91% overall alignment rate
removing re-indexed file:
/scratch/20349675/P18161_219_S92_L004/oral_catalog/sample/P18161_219_S92_L004/59a783840b78ae1046e4c4f6d9607d7a/P18161_219_S92_L004_2.fastq.idx

Launch counting

Executing counting command:
meteor-counter -w inifiles/P18161_219_S92_L004.ini -i /scratch/20349675/P18161_219_S92_L004/oral_catalog/sample/P18161_219_S92_L004 -p /scratch/20349675/P18161_219_S92_L004/oral_catalog -o mapping
######### workspace preparation
######### Meteor task description
Sample name = P18161_219_S92_L004
Library name = P18161_219_S92_L004_2
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_219_S92_L004.ini
######### Meteor task description
Sample name = P18161_219_S92_L004
Library name = P18161_219_S92_L004_1
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_219_S92_L004.ini
######### Task main counting

Job finished !
Done !
Job finished without errors ...
...Sun Jun  6 15:04:12 CEST 2021: Map_reads - done

...Sun Jun  6 15:04:12 CEST 2021: Quantify - begin
SampleCount: 1
RunSampleCount: 2

######### profiling job started

1000000 processed records.
2000000 processed records.
3000000 processed records.
4000000 processed records.
5000000 processed records.
6000000 processed records.
7000000 processed records.
8000000 processed records.
8403558 processed records.

Merged profiled data are saved here: /scratch/20349675/P18161_219_S92_L004/oral_catalog/profiles/P18161_219_S92_L004.tsv

Counting report is saved here: /scratch/20349675/P18161_219_S92_L004/oral_catalog/profiles/P18161_219_S92_L004_counting_report.csv

Extended counting report is saved here: /scratch/20349675/P18161_219_S92_L004/oral_catalog/profiles/P18161_219_S92_L004_extended_counting_report.csv

######### Job finished
...Sun Jun  6 15:04:42 CEST 2021: Quantify - done

...Sun Jun  6 15:04:42 CEST 2021: Recover - begin
sending incremental file list
./
oral_catalog/
oral_catalog/mapping/
oral_catalog/profiles/
oral_catalog/profiles/P18161_219_S92_L004.tsv
         32,768   0%    0.00kB/s    0:00:00       87,461,853 100%  202.38MB/s    0:00:00 (xfr#1, to-chk=8/15)
oral_catalog/profiles/P18161_219_S92_L004_counting_report.csv
            502 100%    1.19kB/s    0:00:00              502 100%    1.19kB/s    0:00:00 (xfr#2, to-chk=7/15)
oral_catalog/profiles/P18161_219_S92_L004_extended_counting_report.csv
            754 100%    1.79kB/s    0:00:00              754 100%    1.79kB/s    0:00:00 (xfr#3, to-chk=6/15)
oral_catalog/profiles/P18161_219_S92_L004_gene_profile.ini
          3,089 100%    7.32kB/s    0:00:00            3,089 100%    7.32kB/s    0:00:00 (xfr#4, to-chk=5/15)
oral_catalog/sample/
oral_catalog/sample/P18161_219_S92_L004/
oral_catalog/sample/P18161_219_S92_L004/P18161_219_S92_L004_1.fastq
         32,768   0%   74.94kB/s   29:37:13      103,841,792   1%   99.03MB/s    0:01:17      272,629,760   3%  130.07MB/s    0:00:57      434,405,376   5%  138.19MB/s    0:00:53      609,746,944   7%  145.48MB/s    0:00:49      783,843,328   9%  162.21MB/s    0:00:43      933,003,264  11%  156.94MB/s    0:00:43    1,030,848,512  12%  141.74MB/s    0:00:47    1,184,694,272  14%  136.63MB/s    0:00:48    1,354,858,496  16%  135.73MB/s    0:00:47    1,497,399,296  18%  134.56MB/s    0:00:47    1,654,849,536  20%  148.77MB/s    0:00:41    1,841,397,760  23%  156.57MB/s    0:00:38    2,011,201,536  25%  156.48MB/s    0:00:37    2,172,420,096  27%  161.02MB/s    0:00:35    2,341,044,224  29%  163.68MB/s    0:00:33    2,515,927,040  31%  160.90MB/s    0:00:33    2,687,172,608  33%  161.29MB/s    0:00:32    2,860,023,808  35%  164.02MB/s    0:00:30    3,027,730,432  37%  163.80MB/s    0:00:29    3,204,874,240  40%  164.34MB/s    0:00:28    3,385,753,600  42%  166.64MB/s    0:00:26    3,546,578,944  44%  163.81MB/s    0:00:26    3,679,027,200  46%  155.40MB/s    0:00:27    3,858,268,160  48%  155.74MB/s    0:00:25    4,022,173,696  50%  151.70MB/s    0:00:25    4,209,246,208  52%  157.95MB/s    0:00:23    4,364,664,832  54%  163.43MB/s    0:00:21    4,536,238,080  56%  161.76MB/s    0:00:20    4,702,830,592  58%  162.40MB/s    0:00:19    4,880,433,152  61%  160.14MB/s    0:00:18    5,047,156,736  63%  162.84MB/s    0:00:17    5,214,470,144  65%  161.82MB/s    0:00:16    5,368,512,512  67%  158.83MB/s    0:00:16    5,550,735,360  69%  159.93MB/s    0:00:14    5,692,489,728  71%  153.94MB/s    0:00:14    5,844,238,336  73%  150.22MB/s    0:00:13    6,011,518,976  75%  153.38MB/s    0:00:12    6,184,271,872  77%  151.12MB/s    0:00:11    6,355,189,760  79%  158.08MB/s    0:00:10    6,511,165,440  81%  159.13MB/s    0:00:09    6,689,062,912  83%  161.66MB/s    0:00:07    6,856,736,768  85%  160.45MB/s    0:00:06    7,004,422,144  87%  154.91MB/s    0:00:06    7,149,748,224  89%  152.17MB/s    0:00:05    7,321,649,152  91%  150.74MB/s    0:00:04    7,487,127,552  93%  150.22MB/s    0:00:03    7,653,818,368  95%  154.75MB/s    0:00:02    7,796,981,760  97%  154.43MB/s    0:00:01    7,970,062,336  99%  154.71MB/s    0:00:00    7,991,315,997 100%  155.22MB/s    0:00:49 (xfr#5, to-chk=3/15)
oral_catalog/sample/P18161_219_S92_L004/P18161_219_S92_L004_1_census_stage_0.ini
            273 100%    2.20kB/s    0:00:00              273 100%    2.20kB/s    0:00:00 (xfr#6, to-chk=2/15)
oral_catalog/sample/P18161_219_S92_L004/P18161_219_S92_L004_2.fastq
         32,768   0%  240.60kB/s    9:09:32      154,697,728   1%  147.53MB/s    0:00:51      337,674,240   4%  161.10MB/s    0:00:46      514,621,440   6%  163.70MB/s    0:00:44      691,306,496   8%  164.90MB/s    0:00:42      847,085,568  10%  165.16MB/s    0:00:41    1,030,848,512  12%  165.35MB/s    0:00:40    1,206,157,312  15%  165.00MB/s    0:00:39    1,371,897,856  17%  162.39MB/s    0:00:39    1,541,177,344  19%  165.61MB/s    0:00:37    1,698,725,888  21%  159.35MB/s    0:00:38    1,873,575,936  23%  159.20MB/s    0:00:37    2,047,901,696  25%  161.25MB/s    0:00:35    2,200,993,792  27%  157.43MB/s    0:00:35    2,366,406,656  29%  159.31MB/s    0:00:34    2,532,343,808  31%  157.18MB/s    0:00:33    2,734,686,208  34%  163.87MB/s    0:00:30    2,882,568,192  36%  162.62MB/s    0:00:30    3,067,117,568  38%  167.19MB/s    0:00:28    3,243,278,336  40%  169.63MB/s    0:00:27    3,411,050,496  42%  161.38MB/s    0:00:27    3,578,822,656  45%  166.08MB/s    0:00:25    3,749,478,400  47%  162.77MB/s    0:00:25    3,910,696,960  49%  159.24MB/s    0:00:24    4,088,692,736  51%  161.68MB/s    0:00:23    4,259,610,624  53%  162.39MB/s    0:00:22    4,431,872,000  55%  162.78MB/s    0:00:21    4,603,609,088  58%  165.29MB/s    0:00:19    4,787,339,264  60%  166.65MB/s    0:00:18    4,958,748,672  62%  166.77MB/s    0:00:17    5,119,705,088  64%  163.50MB/s    0:00:16    5,294,227,456  66%  164.16MB/s    0:00:15    5,468,815,360  68%  161.99MB/s    0:00:14    5,626,167,296  70%  158.69MB/s    0:00:14    5,803,638,784  73%  163.14MB/s    0:00:12    5,974,327,296  75%  162.23MB/s    0:00:11    6,125,780,992  77%  156.71MB/s    0:00:11    6,281,068,544  79%  156.22MB/s    0:00:10    6,442,024,960  81%  152.32MB/s    0:00:09    6,605,012,992  83%  150.44MB/s    0:00:08    6,765,969,408  85%  152.71MB/s    0:00:07    6,918,864,896  87%  152.14MB/s    0:00:06    7,080,345,600  89%  152.26MB/s    0:00:05    7,255,916,544  91%  155.30MB/s    0:00:04    7,409,369,088  93%  153.51MB/s    0:00:03    7,592,247,296  95%  160.63MB/s    0:00:02    7,739,899,904  97%  157.33MB/s    0:00:01    7,903,936,512  99%  154.58MB/s    0:00:00    7,933,225,235 100%  160.52MB/s    0:00:47 (xfr#7, to-chk=1/15)
oral_catalog/sample/P18161_219_S92_L004/P18161_219_S92_L004_2_census_stage_0.ini
            273 100%    1.61kB/s    0:00:00              273 100%    1.61kB/s    0:00:00 (xfr#8, to-chk=0/15)
working/

sent 16,015,918,064 bytes  received 267 bytes  162,598,155.64 bytes/sec
total size is 16,012,007,976  speedup is 1.00
...Sun Jun  6 15:06:20 CEST 2021: Recover - done

