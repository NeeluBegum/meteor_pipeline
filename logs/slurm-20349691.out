...Sat Jun  5 23:19:55 CEST 2021: - begin running script
#!/bin/bash -l
#SBATCH --account=snic2021-5-248
#SBATCH --partition=core
#SBATCH --ntasks=10
#SBATCH --time=2-00:00:00
#SBATCH --job-name=anotherbatch
#SBATCH --mail-user=zn.tportlock@gmail.com
#SBATCH --mail-type=ALL
##SBATCH --output=/proj/uppstore2019028/projects/metagenome/theo/newscripts/meteor/logs/%j 

set -a

function Run {
	echo "...$(date): $1 - begin"
	$@ \
	&& (echo "...$(date): $1 - done"; echo "") \
	|| (echo "...$(date): $1 - failed"; echo ""; exit 1)
}
function Parse_variables {
	v_project_dir=$TMPDIR/$sampleId
	v_workdir="${v_project_dir}/working/$sampleId"
	v_fastqgz1=$(readlink -f ${fastqgzs[0]})
	v_fastqgz2=$(readlink -f ${fastqgzs[1]})
	v_fastqgz1_unzip="${v_workdir}/$(basename $v_fastqgz1 .gz).unzipped"
	v_fastqgz2_unzip="${v_workdir}/$(basename $v_fastqgz2 .gz).unzipped"
	v_trimmedS="${v_workdir}/${sampleId}.trimmed.s.fastq"
	v_final1="${v_workdir}/${sampleId}_1.fastq"
	v_final2="${v_workdir}/${sampleId}_2.fastq"
	v_sampledir=${v_project_dir}/${catalog_type}/sample/${sampleId}
	v_downstream_dir="$v_project_dir/Downstream"
	vars=$(compgen -A variable | grep "^v_.*")
	for var in ${vars}; do echo "${var}=${!var}"; done
	for var in ${vars}; do if [[ -z "${!var}" ]]; then echo "missing argument ${var}" ; return 1 ; fi ; done
}
function Init {
	mkdir -p ${v_project_dir}/${catalog_type}/{sample,mapping,profiles}
	mkdir -p $TMPDIR/reference
	mkdir -p ${v_workdir}
}
function Send {
	cp $v_fastqgz1 ${v_workdir}
	cp $v_fastqgz2 ${v_workdir}
	cp -r ${reference_dir}/* $TMPDIR/reference
	cp -r ${trimFasta} $TMPDIR
}
function Decompress {
	zcat ${v_workdir}/$(basename $v_fastqgz1) > $v_fastqgz1_unzip & pid1=$!
	zcat ${v_workdir}/$(basename $v_fastqgz2) > $v_fastqgz2_unzip & pid2=$!
	trap "kill -2 $pid1 $pid2" SIGINT
	wait
}
function Trim {
	[[ -f $v_fastqgz1_unzip && -f $v_fastqgz2_unzip ]] \
	|| (echo "zip file not found" ; return 1 )
	java -jar ${ALIEN_TRIMMER}/AlienTrimmer.jar \
		-k 10 -l 45 -m 5 -p 40 -q 20 \
		-if ${v_fastqgz1_unzip} -ir ${v_fastqgz2_unzip} -c $TMPDIR/$(basename $trimFasta) \
		-of ${v_final1} -or ${v_final2} -os ${v_trimmedS} \
	|| return 1
}
function Import {
	[[ -f $v_final1 && -f $v_final2 ]] \
	|| (echo "trimmed files not found" ; return 1 )
	mv ${v_final1} ${v_final2} ${v_project_dir}/${catalog_type}/sample &&
	rm -r ${v_workdir}
	ruby ${meteorImportScript} \
		-i ${v_project_dir}/${catalog_type}/sample \
		-p ${catalog_type} \
		-t ${seq_platform} \
		-m "${sampleId}*" \
	|| return 1
}
function Map_reads {
	ruby ${meteor}/meteor.rb \
		-w ${ini_file} \
		-i ${v_sampledir} \
		-p ${v_project_dir}/${catalog_type} \
		-o mapping \
	|| return 1
}
function Quantify {
	${meteor}/meteor-profiler \
		-p ${v_project_dir}/${catalog_type} \
		-f ${v_project_dir}/${catalog_type}/profiles \
		-t smart_shared_reads \
		-w ${ini_file} \
		-o ${sampleId} ${v_project_dir}/${catalog_type}/mapping/${sampleId}/${sampleId}_${v_prefix}_gene_profile/census.dat \
	&& rm -r ${v_project_dir}/${catalog_type}/mapping/${sampleId} \
	|| return 1
}
function Recover {
	rsync -aurvP --remove-source-files $v_project_dir/ $project_dir_rel
}
function PrepareReports {
	inFile=$v_downstream_dir/$1.csv
	outFile=$v_downstream_dir/$1.final.csv
	cat $v_project_dir/$catalog_type/profiles/*$1.csv > $inFile
	head -1 $inFile > ${outFile}.header
	cat $inFile | grep -v sample > ${outFile}.body
	cat ${outFile}.header ${outFile}.body > ${outFile}
	rm ${inFile} ${outFile}.header ${outFile}.body
}
function PrepareGCT {
	inFile=$v_downstream_dir/merged.tsv
	outFile=$v_downstream_dir/merged.final.tsv
	paste $v_project_dir/$catalog_type/profiles/*.tsv > $inFile
	width=$(head -1 $inFile | awk '{print NF}')
	echo $width
	cat $inFile | cut -f1 | sed 's/\#id_fragment/gene_id/g' > ${outFile}.gene
	cat $inFile | awk -v width="$width" 'BEGIN{OFS="\t"}{s="";for(i=2;i<=width;i=i+2){if (i!=width)s=s $i "\t"; if (i==width) s=s $i}; print s}' > ${outFile}.expr
	paste ${outFile}.gene ${outFile}.expr > ${outFile}
	rm ${inFile} ${outFile}.gene ${outFile}.expr
}
function SaveGCT {
	#cd $v_downstream_dir
	Rscript $Rdir/save.gct.r  \
		$v_downstream_dir/merged.final.tsv \
		merged.final \
		$v_downstream_dir \
	|| return 1
}
function Normalize {
	#cd $v_downstream_dir
	Rscript $Rdir/get.norm.downsize.r \
		$v_downstream_dir/merged.final.RData \
		merged.final \
		$v_downstream_dir \
		$v_downstream_dir \
	|| return 1
}
function GetMGS {
	Rscript $Rdir/get.oral.mgs.from.norm.r \
		$v_downstream_dir/merged.final.norm.10M.RData \
		merged.final \
		$v_downstream_dir \
		$v_downstream_dir \
	|| return 1
}

Main() {
	sampleId=$(basename $1 .fastq.gz)
	fastqgzs+=("$2")
	fastqgzs+=("$3")

	Run Parse_variables &&
	Run Init &&
	Run Send &&
	Run Decompress &&
	Run Trim &&
	Run Import &&
	Run Map_reads &&
	Run Quantify &&
	Run Recover
}
Downstream() {
	v_project_dir=$(readlink -f $project_dir_rel)
	v_downstream_dir="$v_project_dir/Downstream"
	mkdir -p $v_downstream_dir

	Run PrepareReports counting_report &&
	Run PrepareReports extended_counting_report &&
	Run PrepareGCT &&
	Run SaveGCT &&
	Run Normalize &&
	Run GetMGS 
}

echo "...$(date): - begin running script"
cat $0
echo ""

# Load modules
echo "...$(date): - load modules"
module load bioinfo-tools
module load ruby/2.6.2
module load AlienTrimmer/0.4.0
module load bowtie2/2.3.4.1
echo "...$(date): - done; echo ''"

# Load ini file
echo "...$(date): - load ini file"
sed -i "s|meteor.reference.dir=.*|meteor.reference.dir=$TMPDIR/reference|g" $1
ini_file=$1
source $ini_file > /dev/null 2>&1
v_prefix=$( grep "meteor.counting.prefix.name" $ini_file | sed "s/^.*=//g" )
cat $ini_file
echo "...$(date): - done; echo ''"

# Run meteor
Main $sample $seq_data_dir/${sample}${forward_identifier} $seq_data_dir/${sample}${reverse_identifier}

# Run the downstream analysis
#Downstream

...Sat Jun  5 23:19:55 CEST 2021: - load modules
Bowtie2 looks for the specified index first in the current directory, then in the directory specified in the BOWTIE2_INDEXES environment variable.
The pregenerated indexes for the reference genonomes are placed under /sw/data/reference/*/*/program_files/bowtie2 for each reference genome
...Sat Jun  5 23:20:02 CEST 2021: - done; echo ''
...Sat Jun  5 23:20:02 CEST 2021: - load ini file
[Pipeline]
sample=P18161_255/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_255_S126_L004
forward_identifier="_R1_001.fastq.gz"
reverse_identifier="_R2_001.fastq.gz"
seq_data_dir="/proj/snic2020-6-153/delivery04021/P18161"
project_dir_rel="/proj/uppstore2019028/projects/metagenome/theo/newscripts/tmp"
catalog_type="oral_catalog"
seq_platform="illumina"
trimFasta="/proj/uppstore2019028/projects/metagenome/alienTrimmerPF8contaminants.fasta"
meteorImportScript="/proj/uppstore2019028/meteor.2019.11.04/MeteorImportFastq.rb"
meteor="/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04"
Rdir="/proj/uppstore2019028/projects/metagenome/meteor_downstream_rscripts"
reference_dir="/proj/uppstore2019028/projects/metagenome/meteor_ref"
[worksession]
meteor.reference.dir=/scratch/20349691/reference
meteor.db.type=binary
meteor.nb.attempts=3
meteor.read.cleaning.program=none
meteor.read.cleaning.cmd=
meteor.mapping.program=bowtie2
meteor.mapping.file.format=sam
meteor.is.cpu.percentage=0
meteor.cpu.count=10
meteor.checksum=md5
meteor.excluded.reference.count=3
[main_reference]
meteor.reference.name=oral_catalog
meteor.matches=10000
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapper.cmd=
meteor.mapping.prefix.name=mapping_vs_oral_catalog
meteor.counting.prefix.name=vs_hs_10_4_oral_catalog
[excluded_reference_1]
meteor.reference.name=Homo_sapiens_GRCh38
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_Homo_sapiens_GRCh38
[excluded_reference_2]
meteor.reference.name=A_thaliana_TAIR10
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_A_thaliana_TAIR10
[excluded_reference_3]
meteor.reference.name=Bos_taurus_UMD3
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_Bos_taurus_UMD3
...Sat Jun  5 23:20:03 CEST 2021: - done; echo ''
...Sat Jun  5 23:20:03 CEST 2021: Parse_variables - begin
v_downstream_dir=/scratch/20349691/P18161_255_S126_L004/Downstream
v_fastqgz1=/crex/proj/snic2020-6-153/nobackup/delivery04021/P18161/P18161_255/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_255_S126_L004_R1_001.fastq.gz
v_fastqgz1_unzip=/scratch/20349691/P18161_255_S126_L004/working/P18161_255_S126_L004/P18161_255_S126_L004_R1_001.fastq.unzipped
v_fastqgz2=/crex/proj/snic2020-6-153/nobackup/delivery04021/P18161/P18161_255/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_255_S126_L004_R2_001.fastq.gz
v_fastqgz2_unzip=/scratch/20349691/P18161_255_S126_L004/working/P18161_255_S126_L004/P18161_255_S126_L004_R2_001.fastq.unzipped
v_final1=/scratch/20349691/P18161_255_S126_L004/working/P18161_255_S126_L004/P18161_255_S126_L004_1.fastq
v_final2=/scratch/20349691/P18161_255_S126_L004/working/P18161_255_S126_L004/P18161_255_S126_L004_2.fastq
v_prefix=vs_hs_10_4_oral_catalog
v_project_dir=/scratch/20349691/P18161_255_S126_L004
v_sampledir=/scratch/20349691/P18161_255_S126_L004/oral_catalog/sample/P18161_255_S126_L004
v_trimmedS=/scratch/20349691/P18161_255_S126_L004/working/P18161_255_S126_L004/P18161_255_S126_L004.trimmed.s.fastq
v_workdir=/scratch/20349691/P18161_255_S126_L004/working/P18161_255_S126_L004
...Sat Jun  5 23:20:03 CEST 2021: Parse_variables - done

...Sat Jun  5 23:20:03 CEST 2021: Init - begin
...Sat Jun  5 23:20:03 CEST 2021: Init - done

...Sat Jun  5 23:20:03 CEST 2021: Send - begin
...Sun Jun  6 00:35:06 CEST 2021: Send - done

...Sun Jun  6 00:35:06 CEST 2021: Decompress - begin
...Sun Jun  6 00:44:47 CEST 2021: Decompress - done

...Sun Jun  6 00:44:47 CEST 2021: Trim - begin
AlienTrimmer main options: -k 10 -l 45 -m 5 -q 20 -p 40 (Phred+33)  /  439 fwd alien sequence(s)  /  7856 fwd k-mers (k=10)  /  439 rev alien sequence(s)  /  7856 rev k-mers (k=10)
[02:00]   1,000,000 read pairs processed:     682,351 trimmed (fwd:     320,412  rev:     361,939)      12,391 removed (fwd:       3,743  rev:       8,648)
[03:57]   2,000,000 read pairs processed:   1,363,185 trimmed (fwd:     633,083  rev:     730,102)      25,338 removed (fwd:       7,247  rev:      18,091)
[05:54]   3,000,000 read pairs processed:   2,046,899 trimmed (fwd:     938,624  rev:   1,108,275)      40,622 removed (fwd:      10,226  rev:      30,396)
[07:50]   4,000,000 read pairs processed:   2,719,919 trimmed (fwd:   1,253,247  rev:   1,466,672)      52,803 removed (fwd:      13,760  rev:      39,043)
[09:45]   5,000,000 read pairs processed:   3,388,499 trimmed (fwd:   1,560,766  rev:   1,827,733)      64,714 removed (fwd:      16,992  rev:      47,722)
[11:42]   6,000,000 read pairs processed:   4,067,848 trimmed (fwd:   1,865,068  rev:   2,202,780)      79,011 removed (fwd:      19,871  rev:      59,140)
[13:38]   7,000,000 read pairs processed:   4,745,656 trimmed (fwd:   2,178,720  rev:   2,566,936)      91,780 removed (fwd:      23,206  rev:      68,574)
[15:33]   8,000,000 read pairs processed:   5,411,908 trimmed (fwd:   2,483,787  rev:   2,928,121)     104,021 removed (fwd:      26,400  rev:      77,621)
[17:29]   9,000,000 read pairs processed:   6,090,192 trimmed (fwd:   2,787,959  rev:   3,302,233)     117,967 removed (fwd:      29,322  rev:      88,645)
[19:25]  10,000,000 read pairs processed:   6,759,184 trimmed (fwd:   3,094,391  rev:   3,664,793)     130,870 removed (fwd:      32,479  rev:      98,391)
[21:20]  11,000,000 read pairs processed:   7,418,777 trimmed (fwd:   3,396,410  rev:   4,022,367)     142,662 removed (fwd:      35,545  rev:     107,117)
[23:17]  12,000,000 read pairs processed:   8,084,141 trimmed (fwd:   3,698,068  rev:   4,386,073)     155,031 removed (fwd:      38,466  rev:     116,565)
[25:15]  13,000,000 read pairs processed:   8,761,482 trimmed (fwd:   4,006,698  rev:   4,754,784)     167,636 removed (fwd:      41,529  rev:     126,107)
[27:10]  14,000,000 read pairs processed:   9,423,985 trimmed (fwd:   4,308,832  rev:   5,115,153)     178,724 removed (fwd:      44,591  rev:     134,133)
[29:05]  15,000,000 read pairs processed:  10,095,425 trimmed (fwd:   4,612,953  rev:   5,482,472)     190,300 removed (fwd:      47,537  rev:     142,763)
[31:02]  16,000,000 read pairs processed:  10,767,806 trimmed (fwd:   4,921,866  rev:   5,845,940)     202,398 removed (fwd:      50,751  rev:     151,647)
[32:57]  17,000,000 read pairs processed:  11,427,549 trimmed (fwd:   5,229,942  rev:   6,197,607)     213,874 removed (fwd:      54,272  rev:     159,602)
[34:52]  18,000,000 read pairs processed:  12,081,129 trimmed (fwd:   5,532,645  rev:   6,548,484)     225,135 removed (fwd:      57,509  rev:     167,626)
[36:49]  19,000,000 read pairs processed:  12,795,470 trimmed (fwd:   5,859,863  rev:   6,935,607)     236,955 removed (fwd:      60,558  rev:     176,397)
[38:50]  20,000,000 read pairs processed:  13,586,311 trimmed (fwd:   6,225,281  rev:   7,361,030)     250,086 removed (fwd:      64,234  rev:     185,852)
[41:13]  21,000,000 read pairs processed:  14,303,824 trimmed (fwd:   6,558,268  rev:   7,745,556)     261,407 removed (fwd:      67,782  rev:     193,625)
[43:23]  22,000,000 read pairs processed:  15,053,732 trimmed (fwd:   6,902,707  rev:   8,151,025)     273,672 removed (fwd:      71,190  rev:     202,482)
[45:32]  23,000,000 read pairs processed:  15,803,510 trimmed (fwd:   7,246,321  rev:   8,557,189)     285,425 removed (fwd:      74,753  rev:     210,672)
[47:53]  24,000,000 read pairs processed:  16,516,918 trimmed (fwd:   7,569,858  rev:   8,947,060)     297,112 removed (fwd:      78,274  rev:     218,838)
[50:23]  25,000,000 read pairs processed:  17,242,435 trimmed (fwd:   7,906,097  rev:   9,336,338)     308,845 removed (fwd:      81,736  rev:     227,109)
[52:50]  26,000,000 read pairs processed:  17,962,420 trimmed (fwd:   8,239,800  rev:   9,722,620)     320,322 removed (fwd:      85,485  rev:     234,837)
[55:20]  27,000,000 read pairs processed:  18,663,946 trimmed (fwd:   8,560,789  rev:  10,103,157)     331,678 removed (fwd:      88,748  rev:     242,930)
[57:15]  28,000,000 read pairs processed:  19,375,478 trimmed (fwd:   8,888,495  rev:  10,486,983)     342,936 removed (fwd:      92,291  rev:     250,645)
[59:34]  29,000,000 read pairs processed:  20,079,279 trimmed (fwd:   9,212,087  rev:  10,867,192)     353,840 removed (fwd:      95,779  rev:     258,061)
[61:56]  30,000,000 read pairs processed:  20,778,460 trimmed (fwd:   9,529,401  rev:  11,249,059)     364,807 removed (fwd:      98,849  rev:     265,958)
[64:19]  31,000,000 read pairs processed:  21,492,823 trimmed (fwd:   9,861,477  rev:  11,631,346)     376,043 removed (fwd:     102,315  rev:     273,728)
[66:48]  32,000,000 read pairs processed:  22,201,078 trimmed (fwd:  10,189,814  rev:  12,011,264)     387,169 removed (fwd:     105,938  rev:     281,231)
[69:18]  33,000,000 read pairs processed:  22,900,015 trimmed (fwd:  10,510,048  rev:  12,389,967)     398,135 removed (fwd:     109,097  rev:     289,038)
[72:37]  34,000,000 read pairs processed:  23,649,308 trimmed (fwd:  10,858,336  rev:  12,790,972)     410,465 removed (fwd:     113,123  rev:     297,342)
[75:01]  35,000,000 read pairs processed:  24,373,588 trimmed (fwd:  11,194,477  rev:  13,179,111)     422,203 removed (fwd:     117,127  rev:     305,076)
[77:24]  36,000,000 read pairs processed:  25,074,492 trimmed (fwd:  11,514,786  rev:  13,559,706)     432,808 removed (fwd:     120,343  rev:     312,465)
[77:25]  36,005,457 read pairs processed:  25,078,240 trimmed (fwd:  11,516,532  rev:  13,561,708)     432,875 removed (fwd:     120,363  rev:     312,512)
...Sun Jun  6 02:02:24 CEST 2021: Trim - done

...Sun Jun  6 02:02:24 CEST 2021: Import - begin
ruby: warning: shebang line ending with \r may cause problems
Import /scratch/20349691/P18161_255_S126_L004/oral_catalog/sample/P18161_255_S126_L004_1.fastq
Import /scratch/20349691/P18161_255_S126_L004/oral_catalog/sample/P18161_255_S126_L004_2.fastq
Importation done!
...Sun Jun  6 02:02:29 CEST 2021: Import - done

...Sun Jun  6 02:02:29 CEST 2021: Map_reads - begin
/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04/meteor.rb:146: warning: constant ::Fixnum is deprecated
/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04/meteor.rb:161: warning: Insecure world writable dir /proj/uppstore2019028/Helen/meteor-linux.2019-11-04 in PATH, mode 042777

Launch mapping


######### Meteor Mapping task description
Sample name = P18161_255_S126_L004
Library name = P18161_255_S126_L004_1
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_255_S126_L004.ini

######### Task main mapping 0
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 10000 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349691/reference/oral_catalog/fasta/oral_catalog_dnaspace_index -U /scratch/20349691/P18161_255_S126_L004/oral_catalog/sample/P18161_255_S126_L004/062c16fe245fd8cf63ab499c204240f3/P18161_255_S126_L004_1.fastq.idx -S /scratch/20349691/P18161_255_S126_L004/oral_catalog/mapping/P18161_255_S126_L004/mapping_vs_oral_catalog_P18161_255_S126_L004_1/P18161_255_S126_L004_1_1.sam
35589079 reads; of these:
  35589079 (100.00%) were unpaired; of these:
    19919530 (55.97%) aligned 0 times
    3721993 (10.46%) aligned exactly 1 time
    11947556 (33.57%) aligned >1 times
44.03% overall alignment rate

######### TaskExcludedMapping(0, 1) ; reference name: Homo_sapiens_GRCh38
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349691/reference/Homo_sapiens_GRCh38/fasta/Homo_sapiens_GRCh38_dnaspace_index -U /scratch/20349691/P18161_255_S126_L004/oral_catalog/sample/P18161_255_S126_L004/062c16fe245fd8cf63ab499c204240f3/P18161_255_S126_L004_1.fastq.idx -S /scratch/20349691/P18161_255_S126_L004/oral_catalog/mapping/P18161_255_S126_L004/mapping_vs_Homo_sapiens_GRCh38_P18161_255_S126_L004_1/P18161_255_S126_L004_1_1.sam
35589079 reads; of these:
  35589079 (100.00%) were unpaired; of these:
    17012449 (47.80%) aligned 0 times
    18576630 (52.20%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
52.20% overall alignment rate

######### TaskExcludedMapping(0, 2) ; reference name: A_thaliana_TAIR10
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349691/reference/A_thaliana_TAIR10/fasta/A_thaliana_TAIR10_dnaspace_index -U /scratch/20349691/P18161_255_S126_L004/oral_catalog/sample/P18161_255_S126_L004/062c16fe245fd8cf63ab499c204240f3/P18161_255_S126_L004_1.fastq.idx -S /scratch/20349691/P18161_255_S126_L004/oral_catalog/mapping/P18161_255_S126_L004/mapping_vs_A_thaliana_TAIR10_P18161_255_S126_L004_1/P18161_255_S126_L004_1_1.sam
35589079 reads; of these:
  35589079 (100.00%) were unpaired; of these:
    35583025 (99.98%) aligned 0 times
    6054 (0.02%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
0.02% overall alignment rate

######### TaskExcludedMapping(0, 3) ; reference name: Bos_taurus_UMD3
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349691/reference/Bos_taurus_UMD3/fasta/Bos_taurus_UMD3_dnaspace_index -U /scratch/20349691/P18161_255_S126_L004/oral_catalog/sample/P18161_255_S126_L004/062c16fe245fd8cf63ab499c204240f3/P18161_255_S126_L004_1.fastq.idx -S /scratch/20349691/P18161_255_S126_L004/oral_catalog/mapping/P18161_255_S126_L004/mapping_vs_Bos_taurus_UMD3_P18161_255_S126_L004_1/P18161_255_S126_L004_1_1.sam
35589079 reads; of these:
  35589079 (100.00%) were unpaired; of these:
    35239913 (99.02%) aligned 0 times
    349166 (0.98%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
0.98% overall alignment rate
removing re-indexed file:
/scratch/20349691/P18161_255_S126_L004/oral_catalog/sample/P18161_255_S126_L004/062c16fe245fd8cf63ab499c204240f3/P18161_255_S126_L004_1.fastq.idx


######### Meteor Mapping task description
Sample name = P18161_255_S126_L004
Library name = P18161_255_S126_L004_2
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_255_S126_L004.ini

######### Task main mapping 1
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 10000 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349691/reference/oral_catalog/fasta/oral_catalog_dnaspace_index -U /scratch/20349691/P18161_255_S126_L004/oral_catalog/sample/P18161_255_S126_L004/062c16fe245fd8cf63ab499c204240f3/P18161_255_S126_L004_2.fastq.idx -S /scratch/20349691/P18161_255_S126_L004/oral_catalog/mapping/P18161_255_S126_L004/mapping_vs_oral_catalog_P18161_255_S126_L004_2/P18161_255_S126_L004_2_1.sam
35589079 reads; of these:
  35589079 (100.00%) were unpaired; of these:
    20219558 (56.81%) aligned 0 times
    3734284 (10.49%) aligned exactly 1 time
    11635237 (32.69%) aligned >1 times
43.19% overall alignment rate

######### TaskExcludedMapping(1, 1) ; reference name: Homo_sapiens_GRCh38
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349691/reference/Homo_sapiens_GRCh38/fasta/Homo_sapiens_GRCh38_dnaspace_index -U /scratch/20349691/P18161_255_S126_L004/oral_catalog/sample/P18161_255_S126_L004/062c16fe245fd8cf63ab499c204240f3/P18161_255_S126_L004_2.fastq.idx -S /scratch/20349691/P18161_255_S126_L004/oral_catalog/mapping/P18161_255_S126_L004/mapping_vs_Homo_sapiens_GRCh38_P18161_255_S126_L004_2/P18161_255_S126_L004_2_1.sam
35589079 reads; of these:
  35589079 (100.00%) were unpaired; of these:
    16993337 (47.75%) aligned 0 times
    18595742 (52.25%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
52.25% overall alignment rate

######### TaskExcludedMapping(1, 2) ; reference name: A_thaliana_TAIR10
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349691/reference/A_thaliana_TAIR10/fasta/A_thaliana_TAIR10_dnaspace_index -U /scratch/20349691/P18161_255_S126_L004/oral_catalog/sample/P18161_255_S126_L004/062c16fe245fd8cf63ab499c204240f3/P18161_255_S126_L004_2.fastq.idx -S /scratch/20349691/P18161_255_S126_L004/oral_catalog/mapping/P18161_255_S126_L004/mapping_vs_A_thaliana_TAIR10_P18161_255_S126_L004_2/P18161_255_S126_L004_2_1.sam
35589079 reads; of these:
  35589079 (100.00%) were unpaired; of these:
    35582974 (99.98%) aligned 0 times
    6105 (0.02%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
0.02% overall alignment rate

######### TaskExcludedMapping(1, 3) ; reference name: Bos_taurus_UMD3
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349691/reference/Bos_taurus_UMD3/fasta/Bos_taurus_UMD3_dnaspace_index -U /scratch/20349691/P18161_255_S126_L004/oral_catalog/sample/P18161_255_S126_L004/062c16fe245fd8cf63ab499c204240f3/P18161_255_S126_L004_2.fastq.idx -S /scratch/20349691/P18161_255_S126_L004/oral_catalog/mapping/P18161_255_S126_L004/mapping_vs_Bos_taurus_UMD3_P18161_255_S126_L004_2/P18161_255_S126_L004_2_1.sam
35589079 reads; of these:
  35589079 (100.00%) were unpaired; of these:
    35239022 (99.02%) aligned 0 times
    350057 (0.98%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
0.98% overall alignment rate
removing re-indexed file:
/scratch/20349691/P18161_255_S126_L004/oral_catalog/sample/P18161_255_S126_L004/062c16fe245fd8cf63ab499c204240f3/P18161_255_S126_L004_2.fastq.idx

Launch counting

Executing counting command:
meteor-counter -w inifiles/P18161_255_S126_L004.ini -i /scratch/20349691/P18161_255_S126_L004/oral_catalog/sample/P18161_255_S126_L004 -p /scratch/20349691/P18161_255_S126_L004/oral_catalog -o mapping
######### workspace preparation
######### Meteor task description
Sample name = P18161_255_S126_L004
Library name = P18161_255_S126_L004_1
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_255_S126_L004.ini
######### Meteor task description
Sample name = P18161_255_S126_L004
Library name = P18161_255_S126_L004_2
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_255_S126_L004.ini
######### Task main counting

Job finished !
Done !
Job finished without errors ...
...Sun Jun  6 19:53:33 CEST 2021: Map_reads - done

...Sun Jun  6 19:53:33 CEST 2021: Quantify - begin
SampleCount: 1
RunSampleCount: 2

######### profiling job started

1000000 processed records.
2000000 processed records.
3000000 processed records.
4000000 processed records.
5000000 processed records.
6000000 processed records.
7000000 processed records.
8000000 processed records.
8403558 processed records.

Merged profiled data are saved here: /scratch/20349691/P18161_255_S126_L004/oral_catalog/profiles/P18161_255_S126_L004.tsv

Counting report is saved here: /scratch/20349691/P18161_255_S126_L004/oral_catalog/profiles/P18161_255_S126_L004_counting_report.csv

Extended counting report is saved here: /scratch/20349691/P18161_255_S126_L004/oral_catalog/profiles/P18161_255_S126_L004_extended_counting_report.csv

######### Job finished
...Sun Jun  6 19:54:07 CEST 2021: Quantify - done

...Sun Jun  6 19:54:07 CEST 2021: Recover - begin
sending incremental file list
./
oral_catalog/
oral_catalog/mapping/
oral_catalog/profiles/
oral_catalog/profiles/P18161_255_S126_L004.tsv
         32,768   0%    0.00kB/s    0:00:00       87,420,521 100%  203.76MB/s    0:00:00 (xfr#1, to-chk=8/15)
oral_catalog/profiles/P18161_255_S126_L004_counting_report.csv
            504 100%    1.20kB/s    0:00:00              504 100%    1.20kB/s    0:00:00 (xfr#2, to-chk=7/15)
oral_catalog/profiles/P18161_255_S126_L004_extended_counting_report.csv
            760 100%    1.81kB/s    0:00:00              760 100%    1.81kB/s    0:00:00 (xfr#3, to-chk=6/15)
oral_catalog/profiles/P18161_255_S126_L004_gene_profile.ini
          3,104 100%    7.39kB/s    0:00:00            3,104 100%    7.39kB/s    0:00:00 (xfr#4, to-chk=5/15)
oral_catalog/sample/
oral_catalog/sample/P18161_255_S126_L004/
oral_catalog/sample/P18161_255_S126_L004/P18161_255_S126_L004_1.fastq
         32,768   0%   73.39kB/s   48:11:28       39,354,368   0%   36.72MB/s    0:05:37      182,222,848   1%   85.99MB/s    0:02:22      336,691,200   2%  106.32MB/s    0:01:53      497,319,936   3%  117.98MB/s    0:01:41      671,121,408   5%  150.74MB/s    0:01:18      805,339,136   6%  148.67MB/s    0:01:18      971,603,968   7%  151.45MB/s    0:01:15    1,144,651,776   8%  154.45MB/s    0:01:13    1,309,179,904  10%  152.24MB/s    0:01:13    1,473,544,192  11%  159.43MB/s    0:01:08    1,621,917,696  12%  155.16MB/s    0:01:09    1,797,226,496  14%  155.70MB/s    0:01:08    1,970,438,144  15%  157.77MB/s    0:01:06    2,140,962,816  16%  159.24MB/s    0:01:04    2,329,214,976  18%  168.76MB/s    0:01:00    2,495,905,792  19%  166.70MB/s    0:00:59    2,669,903,872  20%  166.89MB/s    0:00:58    2,826,010,624  22%  163.45MB/s    0:00:59    3,009,249,280  23%  162.25MB/s    0:00:58    3,183,902,720  25%  164.15MB/s    0:00:56    3,343,351,808  26%  160.68MB/s    0:00:57    3,516,760,064  27%  164.81MB/s    0:00:54    3,672,604,672  28%  158.27MB/s    0:00:55    3,863,445,504  30%  162.14MB/s    0:00:53    4,018,962,432  31%  161.20MB/s    0:00:52    4,180,115,456  32%  158.27MB/s    0:00:52    4,345,397,248  34%  160.53MB/s    0:00:51    4,496,850,944  35%  148.53MB/s    0:00:54    4,666,359,808  36%  151.81MB/s    0:00:51    4,826,923,008  37%  151.67MB/s    0:00:50    4,957,962,240  38%  143.64MB/s    0:00:52    5,118,984,192  40%  148.44MB/s    0:00:50    5,286,002,688  41%  147.85MB/s    0:00:49    5,440,897,024  42%  146.49MB/s    0:00:48    5,629,181,952  44%  160.15MB/s    0:00:43    5,794,463,744  45%  161.17MB/s    0:00:42    5,968,920,576  46%  162.94MB/s    0:00:40    6,140,035,072  48%  166.81MB/s    0:00:38    6,293,848,064  49%  158.59MB/s    0:00:39    6,477,348,864  50%  162.81MB/s    0:00:37    6,633,553,920  52%  158.46MB/s    0:00:37    6,785,892,352  53%  153.98MB/s    0:00:37    6,944,227,328  54%  155.06MB/s    0:00:36    7,094,435,840  55%  146.47MB/s    0:00:37    7,257,489,408  56%  148.02MB/s    0:00:36    7,434,272,768  58%  153.86MB/s    0:00:33    7,588,839,424  59%  152.92MB/s    0:00:32    7,753,334,784  60%  157.13MB/s    0:00:30    7,919,763,456  62%  158.02MB/s    0:00:29    8,077,443,072  63%  153.46MB/s    0:00:29    8,257,044,480  64%  159.43MB/s    0:00:27    8,430,780,416  66%  161.64MB/s    0:00:25    8,587,870,208  67%  158.58MB/s    0:00:25    8,736,931,840  68%  156.53MB/s    0:00:24    8,920,334,336  70%  157.43MB/s    0:00:23    9,084,174,336  71%  155.08MB/s    0:00:22    9,251,225,600  72%  158.27MB/s    0:00:21    9,401,827,328  73%  158.64MB/s    0:00:20    9,575,268,352  75%  156.27MB/s    0:00:19    9,725,116,416  76%  152.93MB/s    0:00:19    9,887,547,392  77%  151.82MB/s    0:00:18   10,044,604,416  78%  153.37MB/s    0:00:17   10,200,055,808  80%  148.29MB/s    0:00:16   10,355,867,648  81%  149.71MB/s    0:00:15   10,508,763,136  82%  147.45MB/s    0:00:14   10,680,205,312  83%  150.86MB/s    0:00:13   10,838,179,840  85%  152.25MB/s    0:00:12   11,006,083,072  86%  155.14MB/s    0:00:10   11,164,745,728  87%  156.52MB/s    0:00:09   11,323,342,848  88%  153.41MB/s    0:00:08   11,470,864,384  90%  150.96MB/s    0:00:08   11,644,010,496  91%  152.17MB/s    0:00:06   11,793,104,896  92%  149.55MB/s    0:00:06   11,943,313,408  93%  147.59MB/s    0:00:05   12,098,011,136  95%  149.30MB/s    0:00:04   12,277,579,776  96%  150.83MB/s    0:00:02   12,429,393,920  97%  151.82MB/s    0:00:01   12,607,127,552  99%  158.38MB/s    0:00:00   12,733,099,184 100%  153.85MB/s    0:01:18 (xfr#5, to-chk=3/15)
oral_catalog/sample/P18161_255_S126_L004/P18161_255_S126_L004_1_census_stage_0.ini
            276 100%    0.32kB/s    0:00:00              276 100%    0.32kB/s    0:00:00 (xfr#6, to-chk=2/15)
oral_catalog/sample/P18161_255_S126_L004/P18161_255_S126_L004_2.fastq
         32,768   0%   37.38kB/s   93:55:09       24,150,016   0%   23.03MB/s    0:08:54      202,113,024   1%   96.42MB/s    0:02:05      392,822,784   3%  124.96MB/s    0:01:35      553,680,896   4%  132.07MB/s    0:01:29      726,990,848   5%  167.70MB/s    0:01:09      890,667,008   7%  164.29MB/s    0:01:09    1,070,006,272   8%  161.57MB/s    0:01:09    1,215,660,032   9%  157.95MB/s    0:01:10    1,380,122,624  10%  155.84MB/s    0:01:10    1,543,077,888  12%  155.66MB/s    0:01:09    1,725,038,592  13%  156.29MB/s    0:01:08    1,892,745,216  14%  161.55MB/s    0:01:04    2,062,417,920  16%  162.79MB/s    0:01:03    2,220,982,272  17%  161.75MB/s    0:01:02    2,407,563,264  19%  162.81MB/s    0:01:01    2,562,686,976  20%  159.81MB/s    0:01:01    2,733,998,080  21%  160.20MB/s    0:01:00    2,906,554,368  22%  163.53MB/s    0:00:58    3,088,678,912  24%  162.51MB/s    0:00:57    3,254,681,600  25%  165.11MB/s    0:00:55    3,424,649,216  27%  164.79MB/s    0:00:54    3,597,959,168  28%  164.97MB/s    0:00:53    3,764,486,144  29%  161.25MB/s    0:00:53    3,927,277,568  31%  160.48MB/s    0:00:53    4,097,245,184  32%  160.48MB/s    0:00:51    4,264,656,896  33%  159.07MB/s    0:00:51    4,434,100,224  35%  159.77MB/s    0:00:50    4,610,621,440  36%  163.04MB/s    0:00:48    4,782,358,528  37%  163.47MB/s    0:00:46    4,951,048,192  39%  163.77MB/s    0:00:45    5,118,918,656  40%  163.40MB/s    0:00:44    5,276,205,056  41%  158.81MB/s    0:00:45    5,460,951,040  43%  161.91MB/s    0:00:43    5,644,156,928  44%  165.37MB/s    0:00:41    5,810,749,440  45%  165.07MB/s    0:00:40    5,976,915,968  47%  167.19MB/s    0:00:38    6,148,849,664  48%  164.13MB/s    0:00:38    6,305,710,080  49%  157.84MB/s    0:00:39    6,488,326,144  51%  161.67MB/s    0:00:37    6,652,755,968  52%  161.25MB/s    0:00:36    6,803,685,376  53%  156.24MB/s    0:00:36    6,983,286,784  55%  161.67MB/s    0:00:34    7,153,221,632  56%  158.64MB/s    0:00:33    7,325,286,400  57%  160.46MB/s    0:00:32    7,481,360,384  59%  160.85MB/s    0:00:31    7,651,491,840  60%  158.64MB/s    0:00:30    7,824,834,560  61%  159.45MB/s    0:00:29    7,988,346,880  63%  157.38MB/s    0:00:28    8,167,424,000  64%  163.69MB/s    0:00:26    8,343,388,160  66%  165.08MB/s    0:00:25    8,522,203,136  67%  166.39MB/s    0:00:24    8,678,342,656  68%  164.63MB/s    0:00:23    8,856,141,824  70%  164.33MB/s    0:00:22    9,018,114,048  71%  160.99MB/s    0:00:21    9,171,927,040  72%  154.94MB/s    0:00:21    9,344,057,344  73%  158.76MB/s    0:00:20    9,514,582,016  75%  157.02MB/s    0:00:19    9,680,551,936  76%  157.98MB/s    0:00:18    9,865,035,776  78%  165.37MB/s    0:00:16   10,026,582,016  79%  162.85MB/s    0:00:15   10,205,003,776  80%  164.73MB/s    0:00:14   10,375,430,144  82%  165.80MB/s    0:00:13   10,540,318,720  83%  161.12MB/s    0:00:12   10,702,061,568  84%  161.13MB/s    0:00:11   10,875,076,608  86%  159.72MB/s    0:00:10   11,045,011,456  87%  159.60MB/s    0:00:09   11,216,617,472  88%  161.24MB/s    0:00:08   11,381,669,888  90%  162.03MB/s    0:00:07   11,550,097,408  91%  161.06MB/s    0:00:06   11,691,950,080  92%  154.36MB/s    0:00:05   11,870,371,840  93%  155.98MB/s    0:00:04   12,022,251,520  95%  152.84MB/s    0:00:03   12,199,526,400  96%  154.95MB/s    0:00:02   12,356,714,496  97%  158.61MB/s    0:00:01   12,537,921,536  99%  159.28MB/s    0:00:00   12,639,643,760 100%  159.45MB/s    0:01:15 (xfr#7, to-chk=1/15)
oral_catalog/sample/P18161_255_S126_L004/P18161_255_S126_L004_2_census_stage_0.ini
            276 100%    0.41kB/s    0:00:00              276 100%    0.41kB/s    0:00:00 (xfr#8, to-chk=0/15)
working/

sent 25,466,385,154 bytes  received 267 bytes  159,663,858.44 bytes/sec
total size is 25,460,168,385  speedup is 1.00
...Sun Jun  6 19:56:46 CEST 2021: Recover - done

