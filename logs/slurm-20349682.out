...Sat Jun  5 23:18:28 CEST 2021: - begin running script
#!/bin/bash -l
#SBATCH --account=snic2021-5-248
#SBATCH --partition=core
#SBATCH --ntasks=10
#SBATCH --time=2-00:00:00
#SBATCH --job-name=anotherbatch
#SBATCH --mail-user=zn.tportlock@gmail.com
#SBATCH --mail-type=ALL
##SBATCH --output=/proj/uppstore2019028/projects/metagenome/theo/newscripts/meteor/logs/%j 

set -a

function Run {
	echo "...$(date): $1 - begin"
	$@ \
	&& (echo "...$(date): $1 - done"; echo "") \
	|| (echo "...$(date): $1 - failed"; echo ""; exit 1)
}
function Parse_variables {
	v_project_dir=$TMPDIR/$sampleId
	v_workdir="${v_project_dir}/working/$sampleId"
	v_fastqgz1=$(readlink -f ${fastqgzs[0]})
	v_fastqgz2=$(readlink -f ${fastqgzs[1]})
	v_fastqgz1_unzip="${v_workdir}/$(basename $v_fastqgz1 .gz).unzipped"
	v_fastqgz2_unzip="${v_workdir}/$(basename $v_fastqgz2 .gz).unzipped"
	v_trimmedS="${v_workdir}/${sampleId}.trimmed.s.fastq"
	v_final1="${v_workdir}/${sampleId}_1.fastq"
	v_final2="${v_workdir}/${sampleId}_2.fastq"
	v_sampledir=${v_project_dir}/${catalog_type}/sample/${sampleId}
	v_downstream_dir="$v_project_dir/Downstream"
	vars=$(compgen -A variable | grep "^v_.*")
	for var in ${vars}; do echo "${var}=${!var}"; done
	for var in ${vars}; do if [[ -z "${!var}" ]]; then echo "missing argument ${var}" ; return 1 ; fi ; done
}
function Init {
	mkdir -p ${v_project_dir}/${catalog_type}/{sample,mapping,profiles}
	mkdir -p $TMPDIR/reference
	mkdir -p ${v_workdir}
}
function Send {
	cp $v_fastqgz1 ${v_workdir}
	cp $v_fastqgz2 ${v_workdir}
	cp -r ${reference_dir}/* $TMPDIR/reference
	cp -r ${trimFasta} $TMPDIR
}
function Decompress {
	zcat ${v_workdir}/$(basename $v_fastqgz1) > $v_fastqgz1_unzip & pid1=$!
	zcat ${v_workdir}/$(basename $v_fastqgz2) > $v_fastqgz2_unzip & pid2=$!
	trap "kill -2 $pid1 $pid2" SIGINT
	wait
}
function Trim {
	[[ -f $v_fastqgz1_unzip && -f $v_fastqgz2_unzip ]] \
	|| (echo "zip file not found" ; return 1 )
	java -jar ${ALIEN_TRIMMER}/AlienTrimmer.jar \
		-k 10 -l 45 -m 5 -p 40 -q 20 \
		-if ${v_fastqgz1_unzip} -ir ${v_fastqgz2_unzip} -c $TMPDIR/$(basename $trimFasta) \
		-of ${v_final1} -or ${v_final2} -os ${v_trimmedS} \
	|| return 1
}
function Import {
	[[ -f $v_final1 && -f $v_final2 ]] \
	|| (echo "trimmed files not found" ; return 1 )
	mv ${v_final1} ${v_final2} ${v_project_dir}/${catalog_type}/sample &&
	rm -r ${v_workdir}
	ruby ${meteorImportScript} \
		-i ${v_project_dir}/${catalog_type}/sample \
		-p ${catalog_type} \
		-t ${seq_platform} \
		-m "${sampleId}*" \
	|| return 1
}
function Map_reads {
	ruby ${meteor}/meteor.rb \
		-w ${ini_file} \
		-i ${v_sampledir} \
		-p ${v_project_dir}/${catalog_type} \
		-o mapping \
	|| return 1
}
function Quantify {
	${meteor}/meteor-profiler \
		-p ${v_project_dir}/${catalog_type} \
		-f ${v_project_dir}/${catalog_type}/profiles \
		-t smart_shared_reads \
		-w ${ini_file} \
		-o ${sampleId} ${v_project_dir}/${catalog_type}/mapping/${sampleId}/${sampleId}_${v_prefix}_gene_profile/census.dat \
	&& rm -r ${v_project_dir}/${catalog_type}/mapping/${sampleId} \
	|| return 1
}
function Recover {
	rsync -aurvP --remove-source-files $v_project_dir/ $project_dir_rel
}
function PrepareReports {
	inFile=$v_downstream_dir/$1.csv
	outFile=$v_downstream_dir/$1.final.csv
	cat $v_project_dir/$catalog_type/profiles/*$1.csv > $inFile
	head -1 $inFile > ${outFile}.header
	cat $inFile | grep -v sample > ${outFile}.body
	cat ${outFile}.header ${outFile}.body > ${outFile}
	rm ${inFile} ${outFile}.header ${outFile}.body
}
function PrepareGCT {
	inFile=$v_downstream_dir/merged.tsv
	outFile=$v_downstream_dir/merged.final.tsv
	paste $v_project_dir/$catalog_type/profiles/*.tsv > $inFile
	width=$(head -1 $inFile | awk '{print NF}')
	echo $width
	cat $inFile | cut -f1 | sed 's/\#id_fragment/gene_id/g' > ${outFile}.gene
	cat $inFile | awk -v width="$width" 'BEGIN{OFS="\t"}{s="";for(i=2;i<=width;i=i+2){if (i!=width)s=s $i "\t"; if (i==width) s=s $i}; print s}' > ${outFile}.expr
	paste ${outFile}.gene ${outFile}.expr > ${outFile}
	rm ${inFile} ${outFile}.gene ${outFile}.expr
}
function SaveGCT {
	#cd $v_downstream_dir
	Rscript $Rdir/save.gct.r  \
		$v_downstream_dir/merged.final.tsv \
		merged.final \
		$v_downstream_dir \
	|| return 1
}
function Normalize {
	#cd $v_downstream_dir
	Rscript $Rdir/get.norm.downsize.r \
		$v_downstream_dir/merged.final.RData \
		merged.final \
		$v_downstream_dir \
		$v_downstream_dir \
	|| return 1
}
function GetMGS {
	Rscript $Rdir/get.oral.mgs.from.norm.r \
		$v_downstream_dir/merged.final.norm.10M.RData \
		merged.final \
		$v_downstream_dir \
		$v_downstream_dir \
	|| return 1
}

Main() {
	sampleId=$(basename $1 .fastq.gz)
	fastqgzs+=("$2")
	fastqgzs+=("$3")

	Run Parse_variables &&
	Run Init &&
	Run Send &&
	Run Decompress &&
	Run Trim &&
	Run Import &&
	Run Map_reads &&
	Run Quantify &&
	Run Recover
}
Downstream() {
	v_project_dir=$(readlink -f $project_dir_rel)
	v_downstream_dir="$v_project_dir/Downstream"
	mkdir -p $v_downstream_dir

	Run PrepareReports counting_report &&
	Run PrepareReports extended_counting_report &&
	Run PrepareGCT &&
	Run SaveGCT &&
	Run Normalize &&
	Run GetMGS 
}

echo "...$(date): - begin running script"
cat $0
echo ""

# Load modules
echo "...$(date): - load modules"
module load bioinfo-tools
module load ruby/2.6.2
module load AlienTrimmer/0.4.0
module load bowtie2/2.3.4.1
echo "...$(date): - done; echo ''"

# Load ini file
echo "...$(date): - load ini file"
sed -i "s|meteor.reference.dir=.*|meteor.reference.dir=$TMPDIR/reference|g" $1
ini_file=$1
source $ini_file > /dev/null 2>&1
v_prefix=$( grep "meteor.counting.prefix.name" $ini_file | sed "s/^.*=//g" )
cat $ini_file
echo "...$(date): - done; echo ''"

# Run meteor
Main $sample $seq_data_dir/${sample}${forward_identifier} $seq_data_dir/${sample}${reverse_identifier}

# Run the downstream analysis
#Downstream

...Sat Jun  5 23:18:28 CEST 2021: - load modules
Bowtie2 looks for the specified index first in the current directory, then in the directory specified in the BOWTIE2_INDEXES environment variable.
The pregenerated indexes for the reference genonomes are placed under /sw/data/reference/*/*/program_files/bowtie2 for each reference genome
...Sat Jun  5 23:18:33 CEST 2021: - done; echo ''
...Sat Jun  5 23:18:47 CEST 2021: - load ini file
[Pipeline]
sample=P18161_226/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_226_S99_L004
forward_identifier="_R1_001.fastq.gz"
reverse_identifier="_R2_001.fastq.gz"
seq_data_dir="/proj/snic2020-6-153/delivery04021/P18161"
project_dir_rel="/proj/uppstore2019028/projects/metagenome/theo/newscripts/tmp"
catalog_type="oral_catalog"
seq_platform="illumina"
trimFasta="/proj/uppstore2019028/projects/metagenome/alienTrimmerPF8contaminants.fasta"
meteorImportScript="/proj/uppstore2019028/meteor.2019.11.04/MeteorImportFastq.rb"
meteor="/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04"
Rdir="/proj/uppstore2019028/projects/metagenome/meteor_downstream_rscripts"
reference_dir="/proj/uppstore2019028/projects/metagenome/meteor_ref"
[worksession]
meteor.reference.dir=/scratch/20349682/reference
meteor.db.type=binary
meteor.nb.attempts=3
meteor.read.cleaning.program=none
meteor.read.cleaning.cmd=
meteor.mapping.program=bowtie2
meteor.mapping.file.format=sam
meteor.is.cpu.percentage=0
meteor.cpu.count=10
meteor.checksum=md5
meteor.excluded.reference.count=3
[main_reference]
meteor.reference.name=oral_catalog
meteor.matches=10000
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapper.cmd=
meteor.mapping.prefix.name=mapping_vs_oral_catalog
meteor.counting.prefix.name=vs_hs_10_4_oral_catalog
[excluded_reference_1]
meteor.reference.name=Homo_sapiens_GRCh38
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_Homo_sapiens_GRCh38
[excluded_reference_2]
meteor.reference.name=A_thaliana_TAIR10
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_A_thaliana_TAIR10
[excluded_reference_3]
meteor.reference.name=Bos_taurus_UMD3
meteor.matches=1
meteor.mismatches=5
meteor.is.perc.mismatches=1
meteor.bestalignment=1
meteor.mapping.prefix.name=mapping_vs_Bos_taurus_UMD3
...Sat Jun  5 23:19:56 CEST 2021: - done; echo ''
...Sat Jun  5 23:19:56 CEST 2021: Parse_variables - begin
v_downstream_dir=/scratch/20349682/P18161_226_S99_L004/Downstream
v_fastqgz1=/crex/proj/snic2020-6-153/nobackup/delivery04021/P18161/P18161_226/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_226_S99_L004_R1_001.fastq.gz
v_fastqgz1_unzip=/scratch/20349682/P18161_226_S99_L004/working/P18161_226_S99_L004/P18161_226_S99_L004_R1_001.fastq.unzipped
v_fastqgz2=/crex/proj/snic2020-6-153/nobackup/delivery04021/P18161/P18161_226/02-FASTQ/201104_A00187_0373_BHGM2CDSXY/P18161_226_S99_L004_R2_001.fastq.gz
v_fastqgz2_unzip=/scratch/20349682/P18161_226_S99_L004/working/P18161_226_S99_L004/P18161_226_S99_L004_R2_001.fastq.unzipped
v_final1=/scratch/20349682/P18161_226_S99_L004/working/P18161_226_S99_L004/P18161_226_S99_L004_1.fastq
v_final2=/scratch/20349682/P18161_226_S99_L004/working/P18161_226_S99_L004/P18161_226_S99_L004_2.fastq
v_prefix=vs_hs_10_4_oral_catalog
v_project_dir=/scratch/20349682/P18161_226_S99_L004
v_sampledir=/scratch/20349682/P18161_226_S99_L004/oral_catalog/sample/P18161_226_S99_L004
v_trimmedS=/scratch/20349682/P18161_226_S99_L004/working/P18161_226_S99_L004/P18161_226_S99_L004.trimmed.s.fastq
v_workdir=/scratch/20349682/P18161_226_S99_L004/working/P18161_226_S99_L004
...Sat Jun  5 23:19:57 CEST 2021: Parse_variables - done

...Sat Jun  5 23:19:57 CEST 2021: Init - begin
...Sat Jun  5 23:19:57 CEST 2021: Init - done

...Sat Jun  5 23:19:57 CEST 2021: Send - begin
...Sat Jun  5 23:53:51 CEST 2021: Send - done

...Sat Jun  5 23:53:53 CEST 2021: Decompress - begin
...Sat Jun  5 23:59:33 CEST 2021: Decompress - done

...Sat Jun  5 23:59:49 CEST 2021: Trim - begin
AlienTrimmer main options: -k 10 -l 45 -m 5 -q 20 -p 40 (Phred+33)  /  439 fwd alien sequence(s)  /  7856 fwd k-mers (k=10)  /  439 rev alien sequence(s)  /  7856 rev k-mers (k=10)
[01:58]   1,000,000 read pairs processed:     647,292 trimmed (fwd:     290,877  rev:     356,415)      15,769 removed (fwd:       4,169  rev:      11,600)
[04:23]   2,000,000 read pairs processed:   1,299,940 trimmed (fwd:     574,809  rev:     725,131)      33,792 removed (fwd:       7,718  rev:      26,074)
[06:20]   3,000,000 read pairs processed:   1,938,856 trimmed (fwd:     860,177  rev:   1,078,679)      48,328 removed (fwd:      11,660  rev:      36,668)
[08:31]   4,000,000 read pairs processed:   2,587,448 trimmed (fwd:   1,142,668  rev:   1,444,780)      65,580 removed (fwd:      15,236  rev:      50,344)
[10:28]   5,000,000 read pairs processed:   3,224,195 trimmed (fwd:   1,425,209  rev:   1,798,986)      80,562 removed (fwd:      19,049  rev:      61,513)
[12:44]   6,000,000 read pairs processed:   3,869,828 trimmed (fwd:   1,705,593  rev:   2,164,235)      97,413 removed (fwd:      22,517  rev:      74,896)
[14:41]   7,000,000 read pairs processed:   4,495,477 trimmed (fwd:   1,982,034  rev:   2,513,443)     112,000 removed (fwd:      26,089  rev:      85,911)
[17:05]   8,000,000 read pairs processed:   5,136,839 trimmed (fwd:   2,261,625  rev:   2,875,214)     127,695 removed (fwd:      29,526  rev:      98,169)
[19:03]   9,000,000 read pairs processed:   5,773,426 trimmed (fwd:   2,540,353  rev:   3,233,073)     142,076 removed (fwd:      33,120  rev:     108,956)
[21:15]  10,000,000 read pairs processed:   6,412,563 trimmed (fwd:   2,821,060  rev:   3,591,503)     156,842 removed (fwd:      36,683  rev:     120,159)
[23:12]  11,000,000 read pairs processed:   7,038,623 trimmed (fwd:   3,102,203  rev:   3,936,420)     171,387 removed (fwd:      40,687  rev:     130,700)
[25:25]  12,000,000 read pairs processed:   7,721,307 trimmed (fwd:   3,405,890  rev:   4,315,417)     187,012 removed (fwd:      44,234  rev:     142,778)
[27:26]  13,000,000 read pairs processed:   8,451,886 trimmed (fwd:   3,733,951  rev:   4,717,935)     204,087 removed (fwd:      48,330  rev:     155,757)
[29:42]  14,000,000 read pairs processed:   9,171,051 trimmed (fwd:   4,053,282  rev:   5,117,769)     219,499 removed (fwd:      52,128  rev:     167,371)
[31:39]  15,000,000 read pairs processed:   9,867,147 trimmed (fwd:   4,358,480  rev:   5,508,667)     234,023 removed (fwd:      55,928  rev:     178,095)
[34:13]  16,000,000 read pairs processed:  10,561,530 trimmed (fwd:   4,668,878  rev:   5,892,652)     248,658 removed (fwd:      59,804  rev:     188,854)
[36:11]  17,000,000 read pairs processed:  11,233,307 trimmed (fwd:   4,965,776  rev:   6,267,531)     262,901 removed (fwd:      63,608  rev:     199,293)
[38:28]  18,000,000 read pairs processed:  11,910,205 trimmed (fwd:   5,266,346  rev:   6,643,859)     276,509 removed (fwd:      67,471  rev:     209,038)
[40:34]  19,000,000 read pairs processed:  12,577,867 trimmed (fwd:   5,559,815  rev:   7,018,052)     290,202 removed (fwd:      71,072  rev:     219,130)
[42:33]  20,000,000 read pairs processed:  13,257,221 trimmed (fwd:   5,864,103  rev:   7,393,118)     303,969 removed (fwd:      74,920  rev:     229,049)
[45:11]  21,000,000 read pairs processed:  13,946,928 trimmed (fwd:   6,169,867  rev:   7,777,061)     318,536 removed (fwd:      78,803  rev:     239,733)
[47:09]  22,000,000 read pairs processed:  14,639,332 trimmed (fwd:   6,479,433  rev:   8,159,899)     332,903 removed (fwd:      83,049  rev:     249,854)
[48:14]  22,478,364 read pairs processed:  14,956,347 trimmed (fwd:   6,619,099  rev:   8,337,248)     339,183 removed (fwd:      84,660  rev:     254,523)
...Sun Jun  6 00:48:43 CEST 2021: Trim - done

...Sun Jun  6 00:48:43 CEST 2021: Import - begin
ruby: warning: shebang line ending with \r may cause problems
Import /scratch/20349682/P18161_226_S99_L004/oral_catalog/sample/P18161_226_S99_L004_1.fastq
Import /scratch/20349682/P18161_226_S99_L004/oral_catalog/sample/P18161_226_S99_L004_2.fastq
Importation done!
...Sun Jun  6 00:48:47 CEST 2021: Import - done

...Sun Jun  6 00:48:47 CEST 2021: Map_reads - begin
/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04/meteor.rb:146: warning: constant ::Fixnum is deprecated
/proj/uppstore2019028/projects/metagenome/software/meteor_linux_2019.11.04/meteor.rb:161: warning: Insecure world writable dir /proj/uppstore2019028/Helen/meteor-linux.2019-11-04 in PATH, mode 042777

Launch mapping


######### Meteor Mapping task description
Sample name = P18161_226_S99_L004
Library name = P18161_226_S99_L004_1
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_226_S99_L004.ini

######### Task main mapping 0
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 10000 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349682/reference/oral_catalog/fasta/oral_catalog_dnaspace_index -U /scratch/20349682/P18161_226_S99_L004/oral_catalog/sample/P18161_226_S99_L004/0e27a3553adf22c64309a255c32c4581/P18161_226_S99_L004_1.fastq.idx -S /scratch/20349682/P18161_226_S99_L004/oral_catalog/mapping/P18161_226_S99_L004/mapping_vs_oral_catalog_P18161_226_S99_L004_1/P18161_226_S99_L004_1_1.sam
22155901 reads; of these:
  22155901 (100.00%) were unpaired; of these:
    14553529 (65.69%) aligned 0 times
    1328251 (6.00%) aligned exactly 1 time
    6274121 (28.32%) aligned >1 times
34.31% overall alignment rate

######### TaskExcludedMapping(0, 1) ; reference name: Homo_sapiens_GRCh38
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349682/reference/Homo_sapiens_GRCh38/fasta/Homo_sapiens_GRCh38_dnaspace_index -U /scratch/20349682/P18161_226_S99_L004/oral_catalog/sample/P18161_226_S99_L004/0e27a3553adf22c64309a255c32c4581/P18161_226_S99_L004_1.fastq.idx -S /scratch/20349682/P18161_226_S99_L004/oral_catalog/mapping/P18161_226_S99_L004/mapping_vs_Homo_sapiens_GRCh38_P18161_226_S99_L004_1/P18161_226_S99_L004_1_1.sam
22155901 reads; of these:
  22155901 (100.00%) were unpaired; of these:
    7548388 (34.07%) aligned 0 times
    14607513 (65.93%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
65.93% overall alignment rate

######### TaskExcludedMapping(0, 2) ; reference name: A_thaliana_TAIR10
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349682/reference/A_thaliana_TAIR10/fasta/A_thaliana_TAIR10_dnaspace_index -U /scratch/20349682/P18161_226_S99_L004/oral_catalog/sample/P18161_226_S99_L004/0e27a3553adf22c64309a255c32c4581/P18161_226_S99_L004_1.fastq.idx -S /scratch/20349682/P18161_226_S99_L004/oral_catalog/mapping/P18161_226_S99_L004/mapping_vs_A_thaliana_TAIR10_P18161_226_S99_L004_1/P18161_226_S99_L004_1_1.sam
22155901 reads; of these:
  22155901 (100.00%) were unpaired; of these:
    22150896 (99.98%) aligned 0 times
    5005 (0.02%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
0.02% overall alignment rate

######### TaskExcludedMapping(0, 3) ; reference name: Bos_taurus_UMD3
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349682/reference/Bos_taurus_UMD3/fasta/Bos_taurus_UMD3_dnaspace_index -U /scratch/20349682/P18161_226_S99_L004/oral_catalog/sample/P18161_226_S99_L004/0e27a3553adf22c64309a255c32c4581/P18161_226_S99_L004_1.fastq.idx -S /scratch/20349682/P18161_226_S99_L004/oral_catalog/mapping/P18161_226_S99_L004/mapping_vs_Bos_taurus_UMD3_P18161_226_S99_L004_1/P18161_226_S99_L004_1_1.sam
22155901 reads; of these:
  22155901 (100.00%) were unpaired; of these:
    21902548 (98.86%) aligned 0 times
    253353 (1.14%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
1.14% overall alignment rate
removing re-indexed file:
/scratch/20349682/P18161_226_S99_L004/oral_catalog/sample/P18161_226_S99_L004/0e27a3553adf22c64309a255c32c4581/P18161_226_S99_L004_1.fastq.idx


######### Meteor Mapping task description
Sample name = P18161_226_S99_L004
Library name = P18161_226_S99_L004_2
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_226_S99_L004.ini

######### Task main mapping 1
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 10000 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349682/reference/oral_catalog/fasta/oral_catalog_dnaspace_index -U /scratch/20349682/P18161_226_S99_L004/oral_catalog/sample/P18161_226_S99_L004/0e27a3553adf22c64309a255c32c4581/P18161_226_S99_L004_2.fastq.idx -S /scratch/20349682/P18161_226_S99_L004/oral_catalog/mapping/P18161_226_S99_L004/mapping_vs_oral_catalog_P18161_226_S99_L004_2/P18161_226_S99_L004_2_1.sam
22155901 reads; of these:
  22155901 (100.00%) were unpaired; of these:
    14764373 (66.64%) aligned 0 times
    1324307 (5.98%) aligned exactly 1 time
    6067221 (27.38%) aligned >1 times
33.36% overall alignment rate

######### TaskExcludedMapping(1, 1) ; reference name: Homo_sapiens_GRCh38
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349682/reference/Homo_sapiens_GRCh38/fasta/Homo_sapiens_GRCh38_dnaspace_index -U /scratch/20349682/P18161_226_S99_L004/oral_catalog/sample/P18161_226_S99_L004/0e27a3553adf22c64309a255c32c4581/P18161_226_S99_L004_2.fastq.idx -S /scratch/20349682/P18161_226_S99_L004/oral_catalog/mapping/P18161_226_S99_L004/mapping_vs_Homo_sapiens_GRCh38_P18161_226_S99_L004_2/P18161_226_S99_L004_2_1.sam
22155901 reads; of these:
  22155901 (100.00%) were unpaired; of these:
    7871142 (35.53%) aligned 0 times
    14284759 (64.47%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
64.47% overall alignment rate

######### TaskExcludedMapping(1, 2) ; reference name: A_thaliana_TAIR10
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349682/reference/A_thaliana_TAIR10/fasta/A_thaliana_TAIR10_dnaspace_index -U /scratch/20349682/P18161_226_S99_L004/oral_catalog/sample/P18161_226_S99_L004/0e27a3553adf22c64309a255c32c4581/P18161_226_S99_L004_2.fastq.idx -S /scratch/20349682/P18161_226_S99_L004/oral_catalog/mapping/P18161_226_S99_L004/mapping_vs_A_thaliana_TAIR10_P18161_226_S99_L004_2/P18161_226_S99_L004_2_1.sam
22155901 reads; of these:
  22155901 (100.00%) were unpaired; of these:
    22150887 (99.98%) aligned 0 times
    5014 (0.02%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
0.02% overall alignment rate

######### TaskExcludedMapping(1, 3) ; reference name: Bos_taurus_UMD3
Executing mapping command:
bowtie2-align-l --mm -p 10 --end-to-end --sensitive -k 1 --no-head --no-sq --no-unal --omit-sec-seq -x /scratch/20349682/reference/Bos_taurus_UMD3/fasta/Bos_taurus_UMD3_dnaspace_index -U /scratch/20349682/P18161_226_S99_L004/oral_catalog/sample/P18161_226_S99_L004/0e27a3553adf22c64309a255c32c4581/P18161_226_S99_L004_2.fastq.idx -S /scratch/20349682/P18161_226_S99_L004/oral_catalog/mapping/P18161_226_S99_L004/mapping_vs_Bos_taurus_UMD3_P18161_226_S99_L004_2/P18161_226_S99_L004_2_1.sam
22155901 reads; of these:
  22155901 (100.00%) were unpaired; of these:
    21913623 (98.91%) aligned 0 times
    242278 (1.09%) aligned exactly 1 time
    0 (0.00%) aligned >1 times
1.09% overall alignment rate
removing re-indexed file:
/scratch/20349682/P18161_226_S99_L004/oral_catalog/sample/P18161_226_S99_L004/0e27a3553adf22c64309a255c32c4581/P18161_226_S99_L004_2.fastq.idx

Launch counting

Executing counting command:
meteor-counter -w inifiles/P18161_226_S99_L004.ini -i /scratch/20349682/P18161_226_S99_L004/oral_catalog/sample/P18161_226_S99_L004 -p /scratch/20349682/P18161_226_S99_L004/oral_catalog -o mapping
######### workspace preparation
######### Meteor task description
Sample name = P18161_226_S99_L004
Library name = P18161_226_S99_L004_1
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_226_S99_L004.ini
######### Meteor task description
Sample name = P18161_226_S99_L004
Library name = P18161_226_S99_L004_2
Project name = oral_catalog
Sequencing device = illumina
Workflow = P18161_226_S99_L004.ini
######### Task main counting

Job finished !
Done !
Job finished without errors ...
...Sun Jun  6 20:00:40 CEST 2021: Map_reads - done

...Sun Jun  6 20:00:40 CEST 2021: Quantify - begin
SampleCount: 1
RunSampleCount: 2

######### profiling job started

1000000 processed records.
2000000 processed records.
3000000 processed records.
4000000 processed records.
5000000 processed records.
6000000 processed records.
7000000 processed records.
8000000 processed records.
8403558 processed records.

Merged profiled data are saved here: /scratch/20349682/P18161_226_S99_L004/oral_catalog/profiles/P18161_226_S99_L004.tsv

Counting report is saved here: /scratch/20349682/P18161_226_S99_L004/oral_catalog/profiles/P18161_226_S99_L004_counting_report.csv

Extended counting report is saved here: /scratch/20349682/P18161_226_S99_L004/oral_catalog/profiles/P18161_226_S99_L004_extended_counting_report.csv

######### Job finished
...Sun Jun  6 20:01:10 CEST 2021: Quantify - done

...Sun Jun  6 20:01:10 CEST 2021: Recover - begin
sending incremental file list
./
oral_catalog/
oral_catalog/mapping/
oral_catalog/profiles/
oral_catalog/profiles/P18161_226_S99_L004.tsv
         32,768   0%    0.00kB/s    0:00:00       85,755,954 100%  219.76MB/s    0:00:00 (xfr#1, to-chk=8/15)
oral_catalog/profiles/P18161_226_S99_L004_counting_report.csv
            502 100%    1.32kB/s    0:00:00              502 100%    1.32kB/s    0:00:00 (xfr#2, to-chk=7/15)
oral_catalog/profiles/P18161_226_S99_L004_extended_counting_report.csv
            753 100%    1.97kB/s    0:00:00              753 100%    1.97kB/s    0:00:00 (xfr#3, to-chk=6/15)
oral_catalog/profiles/P18161_226_S99_L004_gene_profile.ini
          3,095 100%    8.10kB/s    0:00:00            3,095 100%    8.10kB/s    0:00:00 (xfr#4, to-chk=5/15)
oral_catalog/sample/
oral_catalog/sample/P18161_226_S99_L004/
oral_catalog/sample/P18161_226_S99_L004/P18161_226_S99_L004_1.fastq
         32,768   0%   84.21kB/s   26:14:30      103,907,328   1%   99.09MB/s    0:01:17      270,106,624   3%  128.86MB/s    0:00:58      426,541,056   5%  135.68MB/s    0:00:54      498,171,904   6%  118.86MB/s    0:01:01      668,401,664   8%  134.69MB/s    0:00:52      829,980,672  10%  133.58MB/s    0:00:52      985,956,352  12%  133.48MB/s    0:00:50    1,139,965,952  14%  153.13MB/s    0:00:43    1,300,299,776  16%  150.77MB/s    0:00:43    1,457,094,656  18%  149.63MB/s    0:00:42    1,619,656,704  20%  151.20MB/s    0:00:40    1,776,418,816  22%  151.86MB/s    0:00:39    1,939,374,080  24%  152.48MB/s    0:00:38    2,072,084,480  26%  146.74MB/s    0:00:39    2,219,671,552  27%  143.16MB/s    0:00:39    2,385,772,544  29%  145.39MB/s    0:00:37    2,544,467,968  31%  144.37MB/s    0:00:36    2,702,147,584  33%  150.33MB/s    0:00:34    2,775,875,584  34%  131.95MB/s    0:00:38    2,880,012,288  36%  117.25MB/s    0:00:42    3,037,560,832  38%  116.98MB/s    0:00:41    3,194,748,928  40%  116.86MB/s    0:00:39    3,353,640,960  42%  137.85MB/s    0:00:32    3,496,771,584  43%  147.16MB/s    0:00:29    3,655,106,560  45%  147.31MB/s    0:00:28    3,808,985,088  47%  146.45MB/s    0:00:27    3,972,071,424  49%  147.45MB/s    0:00:26    4,129,849,344  51%  150.98MB/s    0:00:24    4,278,747,136  53%  148.72MB/s    0:00:24    4,431,478,784  55%  148.53MB/s    0:00:23    4,587,651,072  57%  146.88MB/s    0:00:22    4,754,276,352  59%  148.99MB/s    0:00:20    4,919,427,072  61%  152.86MB/s    0:00:19    5,057,314,816  63%  149.32MB/s    0:00:18    5,217,878,016  65%  150.37MB/s    0:00:17    5,369,069,568  67%  146.69MB/s    0:00:17    5,526,323,200  69%  144.80MB/s    0:00:16    5,686,689,792  71%  150.17MB/s    0:00:14    5,841,387,520  73%  148.77MB/s    0:00:13    6,002,376,704  75%  151.11MB/s    0:00:12    6,157,860,864  77%  150.68MB/s    0:00:11    6,317,441,024  79%  150.46MB/s    0:00:10    6,480,330,752  81%  152.45MB/s    0:00:09    6,639,190,016  83%  151.94MB/s    0:00:08    6,792,183,808  85%  151.35MB/s    0:00:07    6,954,188,800  87%  151.81MB/s    0:00:06    7,113,048,064  89%  150.85MB/s    0:00:05    7,263,649,792  91%  148.88MB/s    0:00:04    7,405,076,480  93%  146.09MB/s    0:00:03    7,560,527,872  95%  144.60MB/s    0:00:02    7,712,374,784  96%  142.96MB/s    0:00:01    7,875,592,192  98%  145.97MB/s    0:00:00    7,955,470,779 100%  144.63MB/s    0:00:52 (xfr#5, to-chk=3/15)
oral_catalog/sample/P18161_226_S99_L004/P18161_226_S99_L004_1_census_stage_0.ini
            273 100%    0.57kB/s    0:00:00              273 100%    0.57kB/s    0:00:00 (xfr#6, to-chk=2/15)
oral_catalog/sample/P18161_226_S99_L004/P18161_226_S99_L004_2.fastq
         32,768   0%   68.09kB/s   32:14:37       94,797,824   1%   90.41MB/s    0:01:24      254,476,288   3%  121.40MB/s    0:01:01      424,968,192   5%  135.18MB/s    0:00:54      594,837,504   7%  141.93MB/s    0:00:50      789,905,408   9%  165.85MB/s    0:00:41    1,019,052,032  12%  182.43MB/s    0:00:36    1,191,968,768  15%  183.00MB/s    0:00:35    1,368,424,448  17%  184.58MB/s    0:00:34    1,548,877,824  19%  181.09MB/s    0:00:34    1,713,307,648  21%  165.65MB/s    0:00:36    1,881,964,544  23%  164.63MB/s    0:00:35    1,996,849,152  25%  149.94MB/s    0:00:38    2,164,293,632  27%  146.76MB/s    0:00:38    2,328,723,456  29%  146.76MB/s    0:00:37    2,492,137,472  31%  145.51MB/s    0:00:36    2,657,091,584  33%  157.45MB/s    0:00:32    2,815,721,472  35%  155.43MB/s    0:00:31    2,982,117,376  37%  155.90MB/s    0:00:30    3,161,686,016  40%  159.75MB/s    0:00:28    3,344,990,208  42%  164.13MB/s    0:00:27    3,512,827,904  44%  166.33MB/s    0:00:25    3,681,812,480  46%  166.95MB/s    0:00:24    3,863,183,360  48%  167.38MB/s    0:00:23    4,044,128,256  51%  166.81MB/s    0:00:22    4,229,726,208  53%  171.05MB/s    0:00:20    4,390,944,768  55%  169.20MB/s    0:00:20    4,544,561,152  57%  162.58MB/s    0:00:20    4,708,139,008  59%  158.35MB/s    0:00:19    4,896,358,400  61%  158.94MB/s    0:00:18    5,059,084,288  64%  159.30MB/s    0:00:17    5,230,067,712  66%  163.44MB/s    0:00:15    5,369,659,392  67%  157.80MB/s    0:00:15    5,527,404,544  69%  150.57MB/s    0:00:15    5,696,815,104  72%  152.16MB/s    0:00:14    5,885,591,552  74%  156.41MB/s    0:00:12    6,052,413,440  76%  162.90MB/s    0:00:11    6,225,199,104  78%  166.49MB/s    0:00:09    6,474,727,424  81%  185.61MB/s    0:00:07    6,727,565,312  85%  200.89MB/s    0:00:05    6,905,561,088  87%  203.56MB/s    0:00:04    7,094,173,696  89%  207.34MB/s    0:00:03    7,272,136,704  92%  190.26MB/s    0:00:03    7,453,179,904  94%  173.13MB/s    0:00:02    7,611,973,632  96%  168.55MB/s    0:00:01    7,784,988,672  98%  164.83MB/s    0:00:00    7,903,204,529 100%  165.30MB/s    0:00:45 (xfr#7, to-chk=1/15)
oral_catalog/sample/P18161_226_S99_L004/P18161_226_S99_L004_2_census_stage_0.ini
            273 100%    0.42kB/s    0:00:00              273 100%    0.42kB/s    0:00:00 (xfr#8, to-chk=0/15)
working/

sent 15,948,329,747 bytes  received 267 bytes  157,126,404.08 bytes/sec
total size is 15,944,436,158  speedup is 1.00
...Sun Jun  6 20:02:51 CEST 2021: Recover - done

